<!DOCTYPE html>
<html>
<head>
    <title>تحليل موجات إليوت</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { padding: 10px 20px; margin: 10px; }
        #results { margin-top: 20px; }
        img { max-width: 100%; border: 1px solid #ddd; margin: 10px; }
    </style>
</head>
<body>
    <h1>تحليل موجات إليوت - بيانات بينانس</h1>
    <button onclick="runAnalysis()">تشغيل التحليل</button>
    <div id="results"></div>

    <!-- تغيير ترتيب تحميل الملفات -->
    <script src="elliott-wave-image-generator.js"></script>
    <script src="elliott-wave.js"></script>
    
    <script>
    async function runAnalysis() {
        try {
            // 1. جلب البيانات من بينانس
            const response = await fetch('https://api1.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1d&limit=50');
            const klineData = await response.json();
            
            // 2. تحويل البيانات للتنسيق المطلوب
            const formattedData = klineData.map(item => ({
                time: item[0],
                open: parseFloat(item[1]),
                high: parseFloat(item[2]),
                low: parseFloat(item[3]),
                close: parseFloat(item[4]),
                volume: parseFloat(item[5])
            }));
            
            // 3. إنشاء مثيل المحلل
            const analyzer = new ElliottWaveAnalyzer();
            
            // 4. تحليل البيانات
            const analysis = analyzer.analyze(formattedData);
            
            // 5. إنشاء مثيل مولد الصور
            const imageGenerator = new ElliottWaveImageGenerator();
            
            // 6. توليد الصور
            const images = await imageGenerator.generateCompleteImageSet(analysis);
            
            // 7. عرض الصور
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';
            
            for (const [type, imageUrl] of Object.entries(images)) {
                const img = document.createElement('img');
                img.src = imageUrl;
                resultsDiv.appendChild(img);
            }
            
        } catch (error) {
            alert('حدث خطأ: ' + error.message);
        }
    }
    </script>
</body>
</html>
