<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ù„Ù„ Ù…ÙˆØ¬Ø§Øª Ø¥Ù„ÙŠÙˆØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .wave-impulse { color: #28a745; font-weight: bold; }
        .wave-corrective { color: #dc3545; font-weight: bold; }
        .fibonacci-level { background: linear-gradient(90deg, #ffd700, #ffed4e); }
        .pattern-detected { border-left: 4px solid #007bff; }
        .high-confidence { background-color: #d4edda; }
        .medium-confidence { background-color: #fff3cd; }
        .low-confidence { background-color: #f8d7da; }
    </style>
</head>
<body>
    <div class="container-fluid mt-3">
        <h1 class="text-center mb-4">ğŸŒŠ Ù…Ø­Ù„Ù„ Ù…ÙˆØ¬Ø§Øª Ø¥Ù„ÙŠÙˆØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h1>
        
        <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <div class="row align-items-end">
                            <div class="col-md-2">
                                <label class="form-label">Ø±Ù…Ø² Ø§Ù„Ø¹Ù…Ù„Ø©</label>
                                <input type="text" id="symbolInput" class="form-control" placeholder="BTCUSDT" value="BTCUSDT">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©</label>
                                <select id="intervalSelect" class="form-select">
                                    <option value="15m">15 Ø¯Ù‚ÙŠÙ‚Ø©</option>
                                    <option value="1h">Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©</option>
                                    <option value="4h" selected>4 Ø³Ø§Ø¹Ø§Øª</option>
                                    <option value="1d">ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯</option>
                                    <option value="1w">Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ù…ÙˆØ¹</label>
                                <select id="limitSelect" class="form-select">
                                    <option value="200">200</option>
                                    <option value="500" selected>500</option>
                                    <option value="1000">1000</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„ØªØ­Ù„ÙŠÙ„</label>
                                <select id="analysisType" class="form-select">
                                    <option value="full" selected>ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„</option>
                                    <option value="impulse">Ù…ÙˆØ¬Ø§Øª Ø¯Ø§ÙØ¹Ø© ÙÙ‚Ø·</option>
                                    <option value="corrective">Ù…ÙˆØ¬Ø§Øª ØªØµØ­ÙŠØ­ÙŠØ© ÙÙ‚Ø·</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <button id="analyzeBtn" class="btn btn-primary w-100">ØªØ­Ù„ÙŠÙ„ Ù…ØªÙ‚Ø¯Ù…</button>
                            </div>
                            <div class="col-md-2">
                                <button id="scanBtn" class="btn btn-success w-100">Ù…Ø³Ø­ Ø§Ù„Ø³ÙˆÙ‚</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
        <div id="loadingBar" style="display: none;">
            <div class="progress mb-3">
                <div class="progress-bar progress-bar-striped progress-bar-animated" style="width: 100%">
                    <span id="loadingText">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…...</span>
                </div>
            </div>
        </div>

        <!-- Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
        <div class="row">
            <!-- Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5 id="chartTitle">Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù…Ø¹ ØªØ±Ù‚ÙŠÙ… Ø§Ù„Ù…ÙˆØ¬Ø§Øª</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="priceChart" width="800" height="400"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ -->
            <div class="col-md-4">
                <div id="analysisDetails"></div>
            </div>
        </div>

        <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¬Ø§Øª -->
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ©</h5>
                    </div>
                    <div class="card-body">
                        <div id="waveDetails"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ù…Ø³ØªÙˆÙŠØ§Øª ÙÙŠØ¨ÙˆÙ†Ø§ØªØ´ÙŠ -->
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Ù…Ø³ØªÙˆÙŠØ§Øª ÙÙŠØ¨ÙˆÙ†Ø§ØªØ´ÙŠ</h5>
                    </div>
                    <div class="card-body">
                        <div id="fibonacciLevels"></div>
                    </div>
                </div>
            </div>
            
            <!-- Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙƒØªØ´ÙØ© -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙƒØªØ´ÙØ©</h5>
                    </div>
                    <div class="card-body">
                        <div id="detectedPatterns"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© -->
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Ø§Ù„ØªÙˆØµÙŠØ§Øª ÙˆØ§Ù„ØªÙˆÙ‚Ø¹Ø§Øª</h5>
                    </div>
                    <div class="card-body">
                        <div id="advancedRecommendations"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ù…Ø­Ù„Ù„ Ù…ÙˆØ¬Ø§Øª Ø¥Ù„ÙŠÙˆØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
        class AdvancedElliottWaveAnalyzer {
            constructor() {
                this.fibonacciRatios = [0.236, 0.382, 0.5, 0.618, 0.786, 1.0, 1.272, 1.618, 2.618];
                this.wavePatterns = {
                    impulse: ['1', '2', '3', '4', '5'],
                    corrective: ['A', 'B', 'C'],
                    complex: ['W', 'X', 'Y', 'Z']
                };
            }

            // ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            analyzeData(data) {
                if (!data || data.length < 100) {
                    throw new Error('Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ÙƒØ§ÙÙŠØ© Ù„Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…');
                }

                const analysis = {
                    waves: this.identifyWaves(data),
                    patterns: this.detectPatterns(data),
                    fibonacci: this.calculateFibonacci(data),
                    trend: this.analyzeTrend(data),
                    support_resistance: this.findSupportResistance(data),
                    predictions: this.generatePredictions(data),
                    confidence: 0
                };

                analysis.confidence = this.calculateConfidence(analysis);
                return analysis;
            }

            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ¬Ø§Øª
            identifyWaves(data) {
                const waves = [];
                const pivots = this.findPivotPoints(data);
                
                if (pivots.length < 5) return waves;

                // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„Ø¯Ø§ÙØ¹Ø© (1-2-3-4-5)
                const impulseWaves = this.findImpulseWaves(pivots, data);
                waves.push(...impulseWaves);

                // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ© (A-B-C)
                const correctiveWaves = this.findCorrectiveWaves(pivots, data);
                waves.push(...correctiveWaves);

                return waves.sort((a, b) => a.startIndex - b.startIndex);
            }

            // Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø­ÙˆØ±Ø©
            findPivotPoints(data, window = 10) {
                const pivots = [];
                
                for (let i = window; i < data.length - window; i++) {
                    const current = data[i];
                    let isHigh = true;
                    let isLow = true;

                    // ÙØ­Øµ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø­ÙŠØ·Ø©
                    for (let j = i - window; j <= i + window; j++) {
                        if (j === i) continue;
                        
                        if (data[j].high >= current.high) isHigh = false;
                        if (data[j].low <= current.low) isLow = false;
                    }

                    if (isHigh) {
                        pivots.push({
                            index: i,
                            type: 'high',
                            price: current.high,
                            timestamp: current.timestamp
                        });
                    }

                    if (isLow) {
                        pivots.push({
                            index: i,
                            type: 'low',
                            price: current.low,
                            timestamp: current.timestamp
                        });
                    }
                }

                return pivots.sort((a, b) => a.index - b.index);
            }

            // Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„Ø¯Ø§ÙØ¹Ø©
            findImpulseWaves(pivots, data) {
                const impulseWaves = [];
                
                for (let i = 0; i < pivots.length - 4; i++) {
                    const sequence = pivots.slice(i, i + 5);
                    
                    if (this.isValidImpulseSequence(sequence)) {
                        const waves = this.createImpulseWaves(sequence, data);
                        impulseWaves.push(...waves);
                    }
                }

                return impulseWaves;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© ØªØ³Ù„Ø³Ù„ Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„Ø¯Ø§ÙØ¹Ø©
            isValidImpulseSequence(sequence) {
                if (sequence.length !== 5) return false;

                // Ù‚ÙˆØ§Ø¹Ø¯ Ù…ÙˆØ¬Ø§Øª Ø¥Ù„ÙŠÙˆØª Ù„Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„Ø¯Ø§ÙØ¹Ø©
                const rules = [
                    // Ø§Ù„Ù…ÙˆØ¬Ø© 2 Ù„Ø§ ØªØªØ¬Ø§ÙˆØ² Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…ÙˆØ¬Ø© 1
                    sequence[1].type !== sequence[0].type,
                    // Ø§Ù„Ù…ÙˆØ¬Ø© 3 Ù„ÙŠØ³Øª Ø§Ù„Ø£Ù‚ØµØ±
                    true, // Ø³ÙŠØªÙ… ÙØ­ØµÙ‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
                    // Ø§Ù„Ù…ÙˆØ¬Ø© 4 Ù„Ø§ ØªØªØ¯Ø§Ø®Ù„ Ù…Ø¹ Ø§Ù„Ù…ÙˆØ¬Ø© 1
                    true, // Ø³ÙŠØªÙ… ÙØ­ØµÙ‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
                    // Ø§Ù„Ù…ÙˆØ¬Ø© 5 ØªØªØ­Ø±Ùƒ ÙÙŠ Ù†ÙØ³ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù…ÙˆØ¬Ø§Øª 1 Ùˆ 3
                    true
                ];

                return rules.every(rule => rule);
            }

            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„Ø¯Ø§ÙØ¹Ø©
            createImpulseWaves(sequence, data) {
                const waves = [];
                const waveLabels = ['1', '2', '3', '4', '5'];

                for (let i = 0; i < sequence.length - 1; i++) {
                    const start = sequence[i];
                    const end = sequence[i + 1];
                    
                    waves.push({
                        label: waveLabels[i],
                        type: 'impulse',
                        startIndex: start.index,
                        endIndex: end.index,
                        startPrice: start.price,
                        endPrice: end.price,
                        direction: end.price > start.price ? 'up' : 'down',
                        length: Math.abs(end.price - start.price),
                        duration: end.index - start.index,
                        confidence: this.calculateWaveConfidence(start, end, data)
                    });
                }

                return waves;
            }

            // Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©
            findCorrectiveWaves(pivots, data) {
                const correctiveWaves = [];
                
                for (let i = 0; i < pivots.length - 2; i++) {
                    const sequence = pivots.slice(i, i + 3);
                    
                    if (this.isValidCorrectiveSequence(sequence)) {
                        const waves = this.createCorrectiveWaves(sequence, data);
                        correctiveWaves.push(...waves);
                    }
                }

                return correctiveWaves;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© ØªØ³Ù„Ø³Ù„ Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©
            isValidCorrectiveSequence(sequence) {
                if (sequence.length !== 3) return false;
                
                // Ø§Ù„Ù…ÙˆØ¬Ø© B ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† ÙÙŠ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù…Ø¹Ø§ÙƒØ³ Ù„Ù„Ù…ÙˆØ¬Ø© A
                return sequence[0].type !== sequence[1].type && 
                       sequence[1].type !== sequence[2].type;
            }

            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©
            createCorrectiveWaves(sequence, data) {
                const waves = [];
                const waveLabels = ['A', 'B', 'C'];

                for (let i = 0; i < sequence.length - 1; i++) {
                    const start = sequence[i];
                    const end = sequence[i + 1];
                    
                    waves.push({
                        label: waveLabels[i],
                        type: 'corrective',
                        startIndex: start.index,
                        endIndex: end.index,
                        startPrice: start.price,
                        endPrice: end.price,
                        direction: end.price > start.price ? 'up' : 'down',
                                           length: Math.abs(end.price - start.price),
                        duration: end.index - start.index,
                        confidence: this.calculateWaveConfidence(start, end, data)
                    });
                }

                return waves;
            }

            // Ø­Ø³Ø§Ø¨ Ø«Ù‚Ø© Ø§Ù„Ù…ÙˆØ¬Ø©
            calculateWaveConfidence(start, end, data) {
                let confidence = 50;
                
                // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø«Ù‚Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø·ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¬Ø©
                const waveLength = Math.abs(end.price - start.price);
                const avgPrice = (start.price + end.price) / 2;
                const lengthRatio = (waveLength / avgPrice) * 100;
                
                if (lengthRatio > 5) confidence += 20;
                else if (lengthRatio > 2) confidence += 10;
                
                // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø«Ù‚Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬Ù…
                const volumeData = data.slice(start.index, end.index + 1);
                const avgVolume = volumeData.reduce((sum, d) => sum + d.volume, 0) / volumeData.length;
                const recentAvgVolume = data.slice(-20).reduce((sum, d) => sum + d.volume, 0) / 20;
                
                if (avgVolume > recentAvgVolume * 1.5) confidence += 15;
                else if (avgVolume > recentAvgVolume) confidence += 5;
                
                return Math.min(confidence, 95);
            }

            // ÙƒØ´Ù Ø§Ù„Ø£Ù†Ù…Ø§Ø·
            detectPatterns(data) {
                const patterns = [];
                
                // Ù†Ù…Ø· Ø§Ù„Ø±Ø£Ø³ ÙˆØ§Ù„ÙƒØªÙÙŠÙ†
                const headShoulders = this.detectHeadAndShoulders(data);
                if (headShoulders) patterns.push(headShoulders);
                
                // Ù†Ù…Ø· Ø§Ù„Ù…Ø«Ù„Ø«
                const triangle = this.detectTriangle(data);
                if (triangle) patterns.push(triangle);
                
                // Ù†Ù…Ø· Ø§Ù„Ù‚Ù†Ø§Ø©
                const channel = this.detectChannel(data);
                if (channel) patterns.push(channel);
                
                // Ù†Ù…Ø· Ø§Ù„ÙˆØªØ¯
                const wedge = this.detectWedge(data);
                if (wedge) patterns.push(wedge);
                
                return patterns;
            }

            // ÙƒØ´Ù Ù†Ù…Ø· Ø§Ù„Ø±Ø£Ø³ ÙˆØ§Ù„ÙƒØªÙÙŠÙ†
            detectHeadAndShoulders(data) {
                const pivots = this.findPivotPoints(data, 5);
                const highs = pivots.filter(p => p.type === 'high').slice(-5);
                
                if (highs.length < 3) return null;
                
                const [left, head, right] = highs.slice(-3);
                
                if (head.price > left.price && head.price > right.price &&
                    Math.abs(left.price - right.price) / left.price < 0.05) {
                    
                    return {
                        type: 'Head and Shoulders',
                        confidence: 75,
                        direction: 'bearish',
                        neckline: (left.price + right.price) / 2,
                        target: (left.price + right.price) / 2 - (head.price - (left.price + right.price) / 2),
                        description: 'Ù†Ù…Ø· Ø§Ù„Ø±Ø£Ø³ ÙˆØ§Ù„ÙƒØªÙÙŠÙ† - Ø¥Ø´Ø§Ø±Ø© Ù‡Ø¨ÙˆØ·ÙŠØ©'
                    };
                }
                
                return null;
            }

            // ÙƒØ´Ù Ù†Ù…Ø· Ø§Ù„Ù…Ø«Ù„Ø«
            detectTriangle(data) {
                const recentData = data.slice(-50);
                const highs = [];
                const lows = [];
                
                for (let i = 5; i < recentData.length - 5; i++) {
                    let isHigh = true;
                    let isLow = true;
                    
                    for (let j = i - 5; j <= i + 5; j++) {
                        if (j === i) continue;
                        if (recentData[j].high >= recentData[i].high) isHigh = false;
                        if (recentData[j].low <= recentData[i].low) isLow = false;
                    }
                    
                    if (isHigh) highs.push({ index: i, price: recentData[i].high });
                    if (isLow) lows.push({ index: i, price: recentData[i].low });
                }
                
                if (highs.length >= 2 && lows.length >= 2) {
                    const highTrend = this.calculateTrendLine(highs);
                    const lowTrend = this.calculateTrendLine(lows);
                    
                    if (Math.abs(highTrend.slope) > 0.001 || Math.abs(lowTrend.slope) > 0.001) {
                        return {
                            type: 'Triangle',
                            confidence: 65,
                            direction: highTrend.slope < 0 && lowTrend.slope > 0 ? 'converging' : 'diverging',
                            description: 'Ù†Ù…Ø· Ø§Ù„Ù…Ø«Ù„Ø« - ØªÙˆÙ‚Ø¹ ÙƒØ³Ø± Ù‚Ø±ÙŠØ¨'
                        };
                    }
                }
                
                return null;
            }

            // ÙƒØ´Ù Ù†Ù…Ø· Ø§Ù„Ù‚Ù†Ø§Ø©
            detectChannel(data) {
                const recentData = data.slice(-100);
                const pivots = this.findPivotPoints(recentData, 3);
                const highs = pivots.filter(p => p.type === 'high');
                const lows = pivots.filter(p => p.type === 'low');
                
                if (highs.length >= 3 && lows.length >= 3) {
                    const highTrend = this.calculateTrendLine(highs);
                    const lowTrend = this.calculateTrendLine(lows);
                    
                    // ÙØ­Øµ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø®Ø·ÙˆØ· Ù…ØªÙˆØ§Ø²ÙŠØ©
                    if (Math.abs(highTrend.slope - lowTrend.slope) < 0.001) {
                        return {
                            type: 'Channel',
                            confidence: 70,
                            direction: highTrend.slope > 0 ? 'ascending' : 'descending',
                            upperLine: highTrend,
                            lowerLine: lowTrend,
                            description: highTrend.slope > 0 ? 'Ù‚Ù†Ø§Ø© ØµØ§Ø¹Ø¯Ø©' : 'Ù‚Ù†Ø§Ø© Ù‡Ø§Ø¨Ø·Ø©'
                        };
                    }
                }
                
                return null;
            }

            // ÙƒØ´Ù Ù†Ù…Ø· Ø§Ù„ÙˆØªØ¯
            detectWedge(data) {
                const recentData = data.slice(-80);
                const pivots = this.findPivotPoints(recentData, 3);
                const highs = pivots.filter(p => p.type === 'high');
                const lows = pivots.filter(p => p.type === 'low');
                
                if (highs.length >= 3 && lows.length >= 3) {
                    const highTrend = this.calculateTrendLine(highs);
                    const lowTrend = this.calculateTrendLine(lows);
                    
                    // Ø§Ù„ÙˆØªØ¯ Ø§Ù„ØµØ§Ø¹Ø¯: Ø®Ø· Ø§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø© Ø£Ù‚Ù„ Ø§Ù†Ø­Ø¯Ø§Ø±Ø§Ù‹ Ù…Ù† Ø®Ø· Ø§Ù„Ø¯Ø¹Ù…
                    if (highTrend.slope > 0 && lowTrend.slope > 0 && lowTrend.slope > highTrend.slope) {
                        return {
                            type: 'Rising Wedge',
                            confidence: 68,
                            direction: 'bearish',
                            description: 'ÙˆØªØ¯ ØµØ§Ø¹Ø¯ - Ø¥Ø´Ø§Ø±Ø© Ù‡Ø¨ÙˆØ·ÙŠØ© Ù…Ø­ØªÙ…Ù„Ø©'
                        };
                    }
                    
                    // Ø§Ù„ÙˆØªØ¯ Ø§Ù„Ù‡Ø§Ø¨Ø·
                    if (highTrend.slope < 0 && lowTrend.slope < 0 && highTrend.slope > lowTrend.slope) {
                        return {
                            type: 'Falling Wedge',
                            confidence: 68,
                            direction: 'bullish',
                            description: 'ÙˆØªØ¯ Ù‡Ø§Ø¨Ø· - Ø¥Ø´Ø§Ø±Ø© ØµØ§Ø¹Ø¯Ø© Ù…Ø­ØªÙ…Ù„Ø©'
                        };
                    }
                }
                
                return null;
            }

            // Ø­Ø³Ø§Ø¨ Ø®Ø· Ø§Ù„Ø§ØªØ¬Ø§Ù‡
            calculateTrendLine(points) {
                if (points.length < 2) return null;
                
                const n = points.length;
                const sumX = points.reduce((sum, p) => sum + p.index, 0);
                const sumY = points.reduce((sum, p) => sum + p.price, 0);
                const sumXY = points.reduce((sum, p) => sum + (p.index * p.price), 0);
                const sumXX = points.reduce((sum, p) => sum + (p.index * p.index), 0);
                
                const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
                const intercept = (sumY - slope * sumX) / n;
                
                return { slope, intercept };
            }

            // Ø­Ø³Ø§Ø¨ Ù…Ø³ØªÙˆÙŠØ§Øª ÙÙŠØ¨ÙˆÙ†Ø§ØªØ´ÙŠ
            calculateFibonacci(data) {
                const recentData = data.slice(-100);
                const high = Math.max(...recentData.map(d => d.high));
                const low = Math.min(...recentData.map(d => d.low));
                const range = high - low;
                
                const levels = this.fibonacciRatios.map(ratio => ({
                    ratio: ratio,
                    price: high - (range * ratio),
                    level: `${(ratio * 100).toFixed(1)}%`,
                    type: this.getFibonacciLevelType(ratio)
                }));
                
                return {
                    high,
                    low,
                    range,
                    levels: levels.sort((a, b) => b.price - a.price)
                };
            }

            // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ù…Ø³ØªÙˆÙ‰ ÙÙŠØ¨ÙˆÙ†Ø§ØªØ´ÙŠ
            getFibonacciLevelType(ratio) {
                if (ratio === 0.382 || ratio === 0.618) return 'strong';
                if (ratio === 0.5 || ratio === 1.0) return 'medium';
                return 'weak';
            }

            // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡
            analyzeTrend(data) {
                const shortTerm = this.calculateMovingAverage(data.slice(-20));
                const mediumTerm = this.calculateMovingAverage(data.slice(-50));
                const longTerm = this.calculateMovingAverage(data.slice(-100));
                const currentPrice = data[data.length - 1].close;
                
                let trend = 'sideways';
                let strength = 0;
                
                if (currentPrice > shortTerm && shortTerm > mediumTerm && mediumTerm > longTerm) {
                    trend = 'strong_bullish';
                    strength = 85;
                } else if (currentPrice > shortTerm && shortTerm > mediumTerm) {
                    trend = 'bullish';
                    strength = 65;
                } else if (currentPrice < shortTerm && shortTerm < mediumTerm && mediumTerm < longTerm) {
                    trend = 'strong_bearish';
                    strength = 85;
                } else if (currentPrice < shortTerm && shortTerm < mediumTerm) {
                    trend = 'bearish';
                    strength = 65;
                } else {
                    strength = 30;
                }
                
                return {
                    direction: trend,
                    strength,
                    shortMA: shortTerm,
                    mediumMA: mediumTerm,
                    longMA: longTerm,
                    currentPrice
                };
            }

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…ØªØ­Ø±Ùƒ
            calculateMovingAverage(data) {
                return data.reduce((sum, d) => sum + d.close, 0) / data.length;
            }

            // Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø©
            findSupportResistance(data) {
                const pivots = this.findPivotPoints(data, 5);
                const resistanceLevels = pivots.filter(p => p.type === 'high')
                    .map(p => p.price)
                    .sort((a, b) => b - a)
                    .slice(0, 5);
                
                const supportLevels = pivots.filter(p => p.type === 'low')
                    .map(p => p.price)
                    .sort((a, b) => a - b)
                    .slice(0, 5);
                
                return {
                    resistance: resistanceLevels,
                    support: supportLevels,
                    nearest: {
                        resistance: resistanceLevels.find(r => r > data[data.length - 1].close),
                        support: supportLevels.reverse().find(s => s < data[data.length - 1].close)
                    }
                };
            }

            // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª
            generatePredictions(data) {
                const currentPrice = data[data.length - 1].close;
                const trend = this.analyzeTrend(data);
                const fibonacci = this.calculateFibonacci(data);
                
                const predictions = [];
                
                // ØªÙˆÙ‚Ø¹Ø§Øª Ù‚ØµÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ù‰
                if (trend.direction.includes('bullish')) {
                    predictions.push({
                        timeframe: 'short',
                        direction: 'up',
                        target: currentPrice * 1.05,
                        probability: trend.strength,
                        reasoning: 'Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµØ§Ø¹Ø¯ Ù‚ÙˆÙŠ'
                    });
                } else if (trend.direction.includes('bearish')) {
                    predictions.push({
                        timeframe: 'short',
                        direction: 'down',
                        target: currentPrice * 0.95,
                        probability: trend.strength,
                        reasoning: 'Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‡Ø§Ø¨Ø· Ù‚ÙˆÙŠ'
                    });
                }
                
                // ØªÙˆÙ‚Ø¹Ø§Øª Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ø¯Ù‰ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙÙŠØ¨ÙˆÙ†Ø§ØªØ´ÙŠ
                const nextFibLevel = fibonacci.levels.find(l => 
                    Math.abs(l.price - currentPrice) > currentPrice * 0.02
                );
                
                if (nextFibLevel) {
                    predictions.push({
                        timeframe: 'medium',
                        direction: nextFibLevel.price > currentPrice ? 'up' : 'down',
                        target: nextFibLevel.price,
                        probability: nextFibLevel.type === 'strong' ? 70 : 50,
                        reasoning: `Ù…Ø³ØªÙˆÙ‰ ÙÙŠØ¨ÙˆÙ†Ø§ØªØ´ÙŠ ${nextFibLevel.level}`
                    });
                }
                
                return predictions;
            }

            // Ø­Ø³Ø§Ø¨ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
            calculateConfidence(analysis) {
                let confidence = 0;
                let factors = 0;
                
                // Ø«Ù‚Ø© Ø§Ù„Ù…ÙˆØ¬Ø§Øª
                if (analysis.waves.length > 0) {
                    const avgWaveConfidence = analysis.waves.reduce((sum, w)
                    const avgWaveConfidence = analysis.waves.reduce((sum, w) => sum + w.confidence, 0) / analysis.waves.length;
                    confidence += avgWaveConfidence * 0.3;
                    factors += 0.3;
                }
                
                // Ø«Ù‚Ø© Ø§Ù„Ø£Ù†Ù…Ø§Ø·
                if (analysis.patterns.length > 0) {
                    const avgPatternConfidence = analysis.patterns.reduce((sum, p) => sum + p.confidence, 0) / analysis.patterns.length;
                    confidence += avgPatternConfidence * 0.25;
                    factors += 0.25;
                }
                
                // Ø«Ù‚Ø© Ø§Ù„Ø§ØªØ¬Ø§Ù‡
                confidence += analysis.trend.strength * 0.25;
                factors += 0.25;
                
                // Ø«Ù‚Ø© Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª
                if (analysis.predictions.length > 0) {
                    const avgPredictionConfidence = analysis.predictions.reduce((sum, p) => sum + p.probability, 0) / analysis.predictions.length;
                    confidence += avgPredictionConfidence * 0.2;
                    factors += 0.2;
                }
                
                return Math.round(confidence / factors);
            }
        }

        // API Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©
        class AdvancedCryptoAPI {
            constructor() {
                this.baseURL = 'https://api1.binance.com/api/v3';
                this.requestCount = 0;
                this.rateLimitDelay = 200;
                this.popularSymbols = [
                    'BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'ADAUSDT', 'XRPUSDT',
                    'SOLUSDT', 'DOTUSDT', 'DOGEUSDT', 'AVAXUSDT', 'LUNAUSDT',
                    'SHIBUSDT', 'MATICUSDT', 'LTCUSDT', 'LINKUSDT', 'UNIUSDT',
                    'ATOMUSDT', 'ETCUSDT', 'XLMUSDT', 'BCHUSDT', 'FILUSDT',
                    'TRXUSDT', 'EOSUSDT', 'AAVEUSDT', 'GRTUSDT', 'MKRUSDT',
                    'COMPUSDT', 'YFIUSDT', 'SUSHIUSDT', 'SNXUSDT', 'CRVUSDT',
                    'ALPHAUSDT', 'ZENUSDT', 'KSMUSDT', 'CHZUSDT', 'SANDUSDT',
                    'MANAUSDT', 'ENJUSDT', 'GALAUSDT', 'AXSUSDT', 'FTMUSDT'
                ];
            }

            async getKlines(symbol, interval, limit = 500) {
                try {
                    await this.rateLimitCheck();
                    
                    const url = `${this.baseURL}/klines?symbol=${symbol}&interval=${interval}&limit=${limit}`;
                    const response = await fetch(url);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª ${symbol}`);
                    }
                    
                    const data = await response.json();
                    this.requestCount++;
                    
                    return data.map(candle => ({
                        timestamp: candle[0],
                        open: parseFloat(candle[1]),
                        high: parseFloat(candle[2]),
                        low: parseFloat(candle[3]),
                        close: parseFloat(candle[4]),
                        volume: parseFloat(candle[5])
                    }));
                    
                } catch (error) {
                    console.error(`Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª ${symbol}:`, error.message);
                    throw error;
                }
            }

            async getAllSymbols() {
                try {
                    const response = await fetch(`${this.baseURL}/exchangeInfo`);
                    const data = await response.json();
                    
                    return data.symbols
                        .filter(s => s.status === 'TRADING' && s.symbol.endsWith('USDT'))
                        .map(s => s.symbol)
                        .slice(0, 100); // Ø£ÙˆÙ„ 100 Ø±Ù…Ø²
                        
                } catch (error) {
                    console.warn('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ù…ÙˆØ²ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©');
                    return this.popularSymbols;
                }
            }

            async rateLimitCheck() {
                const now = Date.now();
                if (this.lastRequestTime && (now - this.lastRequestTime) < this.rateLimitDelay) {
                    await new Promise(resolve => 
                        setTimeout(resolve, this.rateLimitDelay - (now - this.lastRequestTime))
                    );
                }
                this.lastRequestTime = Date.now();
            }

            getUsageStats() {
                return {
                    totalRequests: this.requestCount,
                    lastRequestTime: this.lastRequestTime,
                    rateLimitDelay: this.rateLimitDelay
                };
            }
        }

        // Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
        class AdvancedElliottWaveApp {
            constructor() {
                this.api = new AdvancedCryptoAPI();
                this.analyzer = new AdvancedElliottWaveAnalyzer();
                this.chart = null;
                this.analysisHistory = [];
            }

            async analyzeSymbol(symbol, interval, limit) {
                try {
                    const data = await this.api.getKlines(symbol, interval, limit);
                    const analysis = this.analyzer.analyzeData(data);
                    
                    const result = {
                        success: true,
                        symbol,
                        interval,
                        timestamp: Date.now(),
                        data,
                        analysis,
                        summary: this.generateSummary(analysis)
                    };
                    
                    this.analysisHistory.unshift(result);
                    if (this.analysisHistory.length > 50) {
                        this.analysisHistory = this.analysisHistory.slice(0, 50);
                    }
                    
                    return result;
                    
                } catch (error) {
                    return {
                        success: false,
                        symbol,
                        interval,
                        timestamp: Date.now(),
                        error: error.message
                    };
                }
            }

            async scanMarket(symbols = null, interval = '4h') {
                if (!symbols) {
                    symbols = await this.api.getAllSymbols();
                }
                
                const results = [];
                const batchSize = 5;
                
                for (let i = 0; i < symbols.length; i += batchSize) {
                    const batch = symbols.slice(i, i + batchSize);
                    const batchPromises = batch.map(symbol => 
                        this.analyzeSymbol(symbol, interval, 200)
                    );
                    
                    const batchResults = await Promise.allSettled(batchPromises);
                    
                    batchResults.forEach((result, index) => {
                        if (result.status === 'fulfilled') {
                            results.push(result.value);
                        } else {
                            results.push({
                                success: false,
                                symbol: batch[index],
                                error: result.reason.message
                            });
                        }
                    });
                    
                    // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
                    const progress = Math.round(((i + batchSize) / symbols.length) * 100);
                    this.updateProgress(`Ù…Ø³Ø­ Ø§Ù„Ø³ÙˆÙ‚: ${progress}%`);
                    
                    // ØªØ£Ø®ÙŠØ± Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª
                    if (i + batchSize < symbols.length) {
                        await new Promise(resolve => setTimeout(resolve, 1000));
                    }
                }
                
                return results.filter(r => r.success).sort((a, b) => b.analysis.confidence - a.analysis.confidence);
            }

            generateSummary(analysis) {
                const summary = {
                    trend: this.getTrendDescription(analysis.trend),
                    waveCount: analysis.waves.length,
                    patternCount: analysis.patterns.length,
                    confidence: analysis.confidence,
                    recommendation: this.getRecommendation(analysis),
                    riskLevel: this.getRiskLevel(analysis)
                };
                
                return summary;
            }

            getTrendDescription(trend) {
                const descriptions = {
                    'strong_bullish': 'Ø§ØªØ¬Ø§Ù‡ ØµØ§Ø¹Ø¯ Ù‚ÙˆÙŠ Ø¬Ø¯Ø§Ù‹ ğŸš€',
                    'bullish': 'Ø§ØªØ¬Ø§Ù‡ ØµØ§Ø¹Ø¯ ğŸ“ˆ',
                    'strong_bearish': 'Ø§ØªØ¬Ø§Ù‡ Ù‡Ø§Ø¨Ø· Ù‚ÙˆÙŠ Ø¬Ø¯Ø§Ù‹ ğŸ“‰',
                    'bearish': 'Ø§ØªØ¬Ø§Ù‡ Ù‡Ø§Ø¨Ø· ğŸ“‰',
                    'sideways': 'Ø­Ø±ÙƒØ© Ø¬Ø§Ù†Ø¨ÙŠØ© â†”ï¸'
                };
                
                return descriptions[trend.direction] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            }

            getRecommendation(analysis) {
                if (analysis.confidence < 50) return 'Ø§Ù†ØªØ¸Ø§Ø± - Ø«Ù‚Ø© Ù…Ù†Ø®ÙØ¶Ø©';
                
                if (analysis.trend.direction.includes('bullish')) {
                    return analysis.confidence > 70 ? 'Ø´Ø±Ø§Ø¡ Ù‚ÙˆÙŠ ğŸŸ¢' : 'Ø´Ø±Ø§Ø¡ ğŸŸ¢';
                } else if (analysis.trend.direction.includes('bearish')) {
                    return analysis.confidence > 70 ? 'Ø¨ÙŠØ¹ Ù‚ÙˆÙŠ ğŸ”´' : 'Ø¨ÙŠØ¹ ğŸ”´';
                }
                
                return 'Ø§Ù†ØªØ¸Ø§Ø± â³';
            }

            getRiskLevel(analysis) {
                if (analysis.confidence > 80) return 'Ù…Ù†Ø®ÙØ¶';
                if (analysis.confidence > 60) return 'Ù…ØªÙˆØ³Ø·';
                return 'Ø¹Ø§Ù„ÙŠ';
            }

            updateProgress(text) {
                const loadingText = document.getElementById('loadingText');
                if (loadingText) {
                    loadingText.textContent = text;
                }
            }

            drawChart(result) {
                const ctx = document.getElementById('priceChart').getContext('2d');
                
                if (this.chart) {
                    this.chart.destroy();
                }
                
                const labels = result.data.map(d => new Date(d.timestamp).toLocaleDateString('ar-SA'));
                const prices = result.data.map(d => d.close);
                
                // Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø§Ø· Ø§Ù„Ù…ÙˆØ¬Ø§Øª
                const waveAnnotations = result.analysis.waves.map(wave => ({
                    type: 'point',
                    xValue: labels[wave.endIndex],
                    yValue: wave.endPrice,
                    backgroundColor: wave.type === 'impulse' ? 'rgba(40, 167, 69, 0.8)' : 'rgba(220, 53, 69, 0.8)',
                    radius: 8,
                    label: {
                        content: wave.label,
                        enabled: true,
                        position: 'top'
                    }
                }));
                
                this.chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Ø§Ù„Ø³Ø¹Ø±',
                            data: prices,
                            borderColor: 'rgb(75, 192, 192)',
                            backgroundColor: 'rgba(75, 192, 192, 0.1)',
                            tension: 0.1,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            title: {
                                display: true,
                                text: `${result.symbol} - ${result.interval}`
                            },
                            annotation: {
                                annotations: waveAnnotations
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: false
                            }
                        }
                    }
                });
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        const app = new AdvancedElliottWaveApp();
        
        // Ø§Ù„Ø¹Ù†Ø§ØµØ±
        const analyzeBtn = document.getElementById('analyzeBtn');
        const scanBtn = document.getElementById('scanBtn');
        const loadingBar = document.getElementById('loadingBar');
        const analysisDetails = document.getElementById('analysisDetails');
        const waveDetails = document.getElementById('waveDetails');
        const fibonacciLevels = document.getElementById('fibonacciLevels');
        const detectedPatterns = document.getElementById('detectedPatterns');
        const advancedRecommendations = document.getElementById('advancedRecommendations');

        // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
        async function analyzeAdvanced() {
            const symbol = document.getElementById('symbolInput').value.toUpperCase();
            const interval = document.getElementById('intervalSelect').value;
            const limit = parseInt(document.getElementById('limitSelect').value);
            
            if (!symbol) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„Ø¹Ù…Ù„Ø©');
                return;
            }

            showLoading('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…...');
            
            try {
                const result = await app.analyzeSymbol(symbol, interval, limit);
                
                if (result.success) {
                    displayAdvancedAnalysis(result);
                    app.drawChart(result);
                } else {
                    showError(result.error);
                }
                
            } catch (error) {
                showError(error.message);
            } finally {
                hideLoading();
            }
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø­ Ø§Ù„Ø³ÙˆÙ‚
        async function scanMarket() {
            showLoading('Ø¬Ø§Ø±ÙŠ Ù…Ø³Ø­ Ø§Ù„Ø³ÙˆÙ‚...');
            
            try {
                const results = await app.scanMarket(null, '4h');
                displayMarketScan(results);
                
            } catch (error) {
                showError(error.message);
            } finally {
                hideLoading();
            }
        }

        // Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
        function displayAdvancedAnalysis(result) {
            const analysis = result.analysis;
            
            // ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            analysisDetails.innerHTML = `
                <div class="card mb-3 ${getConfidenceClass(analysis.confidence)}">
                    <div class="card-header">
                        <h6>Ù…Ù„Ø®Øµ Ø§Ù„ØªØ­Ù„ÙŠÙ„</h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-6">
                                <strong>Ø§Ù„Ø§ØªØ¬Ø§Ù‡:</strong><br>
                                <span class="badge bg-primary">${result.summary.trend}</span>
                            </div>
                            <div class="col-6">
                                <strong>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©:</strong><br>
                                <span class="badge bg-info">${analysis.confidence}%</span>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col
                            <div class="col-6">
                                <strong>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¬Ø§Øª:</strong><br>
                                <span class="badge bg-success">${result.summary.waveCount}</span>
                            </div>
                            <div class="col-6">
                                <strong>Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙƒØªØ´ÙØ©:</strong><br>
                                <span class="badge bg-warning">${result.summary.patternCount}</span>
                            </div>
                        </div>
                        <hr>
                        <div class="text-center">
                            <strong>Ø§Ù„ØªÙˆØµÙŠØ©:</strong><br>
                            <span class="badge bg-${getRecommendationColor(result.summary.recommendation)} fs-6">
                                ${result.summary.recommendation}
                            </span>
                        </div>
                        <div class="mt-2 text-center">
                            <small class="text-muted">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©: ${result.summary.riskLevel}</small>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-3">
                    <div class="card-header">
                        <h6>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡</h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-2">
                            <small>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ:</small>
                            <strong>${analysis.trend.currentPrice.toFixed(4)}</strong>
                        </div>
                        <div class="mb-2">
                            <small>Ø§Ù„Ù…ØªÙˆØ³Ø· Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰:</small>
                            <span class="${analysis.trend.currentPrice > analysis.trend.shortMA ? 'text-success' : 'text-danger'}">
                                ${analysis.trend.shortMA.toFixed(4)}
                            </span>
                        </div>
                        <div class="mb-2">
                            <small>Ø§Ù„Ù…ØªÙˆØ³Ø· Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø¯Ù‰:</small>
                            <span class="${analysis.trend.shortMA > analysis.trend.mediumMA ? 'text-success' : 'text-danger'}">
                                ${analysis.trend.mediumMA.toFixed(4)}
                            </span>
                        </div>
                        <div class="mb-2">
                            <small>Ø§Ù„Ù…ØªÙˆØ³Ø· Ø·ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¯Ù‰:</small>
                            <span class="${analysis.trend.mediumMA > analysis.trend.longMA ? 'text-success' : 'text-danger'}">
                                ${analysis.trend.longMA.toFixed(4)}
                            </span>
                        </div>
                        <div class="progress mt-3">
                            <div class="progress-bar bg-${analysis.trend.strength > 70 ? 'success' : analysis.trend.strength > 40 ? 'warning' : 'danger'}" 
                                 style="width: ${analysis.trend.strength}%">
                                Ù‚ÙˆØ© Ø§Ù„Ø§ØªØ¬Ø§Ù‡: ${analysis.trend.strength}%
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h6>Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø©</h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-6">
                                <strong class="text-danger">Ù…Ù‚Ø§ÙˆÙ…Ø©:</strong><br>
                                ${analysis.support_resistance.resistance.slice(0, 3).map(r => 
                                    `<small class="d-block">${r.toFixed(4)}</small>`
                                ).join('')}
                            </div>
                            <div class="col-6">
                                <strong class="text-success">Ø¯Ø¹Ù…:</strong><br>
                                ${analysis.support_resistance.support.slice(0, 3).map(s => 
                                    `<small class="d-block">${s.toFixed(4)}</small>`
                                ).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¬Ø§Øª
            displayWaveDetails(analysis.waves);
            
            // Ù…Ø³ØªÙˆÙŠØ§Øª ÙÙŠØ¨ÙˆÙ†Ø§ØªØ´ÙŠ
            displayFibonacciLevels(analysis.fibonacci);
            
            // Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙƒØªØ´ÙØ©
            displayDetectedPatterns(analysis.patterns);
            
            // Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
            displayAdvancedRecommendations(analysis.predictions, result.summary);
        }

        // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¬Ø§Øª
        function displayWaveDetails(waves) {
            if (waves.length === 0) {
                waveDetails.innerHTML = '<div class="alert alert-info">Ù„Ù… ÙŠØªÙ… Ø§ÙƒØªØ´Ø§Ù Ù…ÙˆØ¬Ø§Øª ÙˆØ§Ø¶Ø­Ø©</div>';
                return;
            }

            const waveTable = waves.map(wave => `
                <tr class="${wave.type === 'impulse' ? 'table-success' : 'table-warning'}">
                    <td>
                        <span class="badge bg-${wave.type === 'impulse' ? 'success' : 'danger'}">
                            ${wave.label}
                        </span>
                    </td>
                    <td>
                        <span class="wave-${wave.type}">${wave.type === 'impulse' ? 'Ø¯Ø§ÙØ¹Ø©' : 'ØªØµØ­ÙŠØ­ÙŠØ©'}</span>
                    </td>
                    <td>
                        <i class="fas fa-arrow-${wave.direction === 'up' ? 'up text-success' : 'down text-danger'}"></i>
                        ${wave.direction === 'up' ? 'ØµØ§Ø¹Ø¯' : 'Ù‡Ø§Ø¨Ø·'}
                    </td>
                    <td>${wave.startPrice.toFixed(4)}</td>
                    <td>${wave.endPrice.toFixed(4)}</td>
                    <td>${wave.length.toFixed(4)}</td>
                    <td>${wave.duration}</td>
                    <td>
                        <div class="progress" style="height: 15px;">
                            <div class="progress-bar bg-${wave.confidence > 70 ? 'success' : wave.confidence > 50 ? 'warning' : 'danger'}" 
                                 style="width: ${wave.confidence}%">
                                ${wave.confidence.toFixed(0)}%
                            </div>
                        </div>
                    </td>
                </tr>
            `).join('');

            waveDetails.innerHTML = `
                <div class="table-responsive">
                    <table class="table table-sm table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>Ø§Ù„Ù…ÙˆØ¬Ø©</th>
                                <th>Ø§Ù„Ù†ÙˆØ¹</th>
                                <th>Ø§Ù„Ø§ØªØ¬Ø§Ù‡</th>
                                <th>Ø³Ø¹Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</th>
                                <th>Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</th>
                                <th>Ø§Ù„Ø·ÙˆÙ„</th>
                                <th>Ø§Ù„Ù…Ø¯Ø©</th>
                                <th>Ø§Ù„Ø«Ù‚Ø©</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${waveTable}
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-3">
                    <div class="row">
                        <div class="col-6">
                            <div class="card border-success">
                                <div class="card-body text-center">
                                    <h6 class="card-title text-success">Ù…ÙˆØ¬Ø§Øª Ø¯Ø§ÙØ¹Ø©</h6>
                                    <h4 class="text-success">${waves.filter(w => w.type === 'impulse').length}</h4>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="card border-danger">
                                <div class="card-body text-center">
                                    <h6 class="card-title text-danger">Ù…ÙˆØ¬Ø§Øª ØªØµØ­ÙŠØ­ÙŠØ©</h6>
                                    <h4 class="text-danger">${waves.filter(w => w.type === 'corrective').length}</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Ø¹Ø±Ø¶ Ù…Ø³ØªÙˆÙŠØ§Øª ÙÙŠØ¨ÙˆÙ†Ø§ØªØ´ÙŠ
        function displayFibonacciLevels(fibonacci) {
            const currentPrice = fibonacci.high - (fibonacci.range * 0.5); // ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ
            
            const fibTable = fibonacci.levels.map(level => {
                const distance = Math.abs(level.price - currentPrice);
                const isNear = distance < (fibonacci.range * 0.05);
                
                return `
                    <tr class="${isNear ? 'table-warning' : ''} ${level.type === 'strong' ? 'fibonacci-level' : ''}">
                        <td>
                            <span class="badge bg-${level.type === 'strong' ? 'warning' : level.type === 'medium' ? 'info' : 'secondary'}">
                                ${level.level}
                            </span>
                        </td>
                        <td>${level.price.toFixed(4)}</td>
                        <td>
                            <span class="badge bg-${level.type === 'strong' ? 'danger' : level.type === 'medium' ? 'warning' : 'secondary'}">
                                ${level.type === 'strong' ? 'Ù‚ÙˆÙŠ' : level.type === 'medium' ? 'Ù…ØªÙˆØ³Ø·' : 'Ø¶Ø¹ÙŠÙ'}
                            </span>
                        </td>
                        <td>
                            ${isNear ? '<i class="fas fa-bullseye text-warning"></i> Ù‚Ø±ÙŠØ¨' : ''}
                        </td>
                    </tr>
                `;
            }).join('');

            fibonacciLevels.innerHTML = `
                <div class="mb-3">
                    <div class="row text-center">
                        <div class="col-4">
                            <div class="card border-success">
                                <div class="card-body">
                                    <small>Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø±</small>
                                    <h6 class="text-success">${fibonacci.high.toFixed(4)}</h6>
                                </div>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="card border-info">
                                <div class="card-body">
                                    <small>Ø§Ù„Ù…Ø¯Ù‰</small>
                                    <h6 class="text-info">${fibonacci.range.toFixed(4)}</h6>
                                </div>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="card border-danger">
                                <div class="card-body">
                                    <small>Ø£Ù‚Ù„ Ø³Ø¹Ø±</small>
                                    <h6 class="text-danger">${fibonacci.low.toFixed(4)}</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead class="table-dark">
                            <tr>
                                <th>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</th>
                                <th>Ø§Ù„Ø³Ø¹Ø±</th>
                                <th>Ø§Ù„Ù‚ÙˆØ©</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${fibTable}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙƒØªØ´ÙØ©
        function displayDetectedPatterns(patterns) {
            if (patterns.length === 0) {
                detectedPatterns.innerHTML = '<div class="alert alert-info">Ù„Ù… ÙŠØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø£Ù†Ù…Ø§Ø· ÙˆØ§Ø¶Ø­Ø©</div>';
                return;
            }

            const patternCards = patterns.map(pattern => `
                <div class="card mb-3 pattern-detected">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6 class="card-title">
                                    <i class="fas fa-chart-line"></i>
                                    ${pattern.type}
                                </h6>
                                <p class="card-text">${pattern.description}</p>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-${pattern.confidence > 70 ? 'success' : pattern.confidence > 50 ? 'warning' : 'danger'} fs-6">
                                    ${pattern.confidence}%
                                </span>
                                <br>
                                <small class="text-muted">${pattern.direction}</small>
                            </div>
                        </div>
                        
                        ${pattern.target ? `
                            <div class="mt-2">
                                <small><strong>Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:</strong> ${pattern.target.toFixed(4)}</small>
                            </div>
                        ` : ''}
                        
                        ${pattern.neckline ? `
                            <div class="mt-1">
                                <small><strong>Ø®Ø· Ø§Ù„Ø¹Ù†Ù‚:</strong> ${pattern.neckline.toFixed(4)}</small>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');

            detectedPatterns.innerHTML = patternCards;
        }

        // Ø¹Ø±Ø¶ Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
        function displayAdvancedRecommendations(predictions, summary) {
            const recommendationCards = predictions.map(pred => `
                <div class="card mb-3">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6 class="card-title">
                                    <i class="fas fa-${pred.direction === 'up' ? 'arrow-up text-success' : 'arrow-down text-danger'}"></i>
                                    ØªÙˆÙ‚Ø¹ ${pred.timeframe === 'short' ? 'Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰' : 'Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø¯Ù‰'}
                                </h6>
                                <p class="card-text">${pred.reasoning}</p>
                                <div class="mt-2">
                                    <strong>Ø§Ù„Ù‡Ø¯Ù:</strong> 
                                    <span class="badge bg-${pred.direction === 'up' ? 'success' : 'danger'}">
                                        ${pred.target.toFixed(4)}
                                    </span>
                                </div>
                            </div>
                            <div class="text-end">
                                <div class="progress" style="width: 80px; height: 20px;">
                                    <div class="progress-bar bg-${pred.probability > 70 ? 'success' : pred.probability > 50 ? 'warning' : 'danger'}" 
                                         style="width: ${pred.probability}%">
                                        ${pred.probability}
                                        ${pred.probability}%
                                    </div>
                                </div>
                                <small class="text-muted">Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ©</small>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');

            const riskManagement = `
                <div class="card border-warning mb-3">
                    <div class="card-header bg-warning text-dark">
                        <h6 class="mb-0">
                            <i class="fas fa-shield-alt"></i>
                            Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <strong>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©:</strong>
                                <span class="badge bg-${summary.riskLevel === 'Ù…Ù†Ø®ÙØ¶' ? 'success' : summary.riskLevel === 'Ù…ØªÙˆØ³Ø·' ? 'warning' : 'danger'}">
                                    ${summary.riskLevel}
                                </span>
                            </div>
                            <div class="col-md-6">
                                <strong>Ø­Ø¬Ù… Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ù‚ØªØ±Ø­:</strong>
                                <span class="badge bg-info">
                                    ${summary.riskLevel === 'Ù…Ù†Ø®ÙØ¶' ? '3-5%' : summary.riskLevel === 'Ù…ØªÙˆØ³Ø·' ? '1-3%' : '0.5-1%'}
                                </span>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-md-12">
                                <small class="text-muted">
                                    <i class="fas fa-info-circle"></i>
                                    ${getRiskAdvice(summary.riskLevel)}
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            const tradingPlan = `
                <div class="card border-primary">
                    <div class="card-header bg-primary text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-chart-line"></i>
                            Ø®Ø·Ø© Ø§Ù„ØªØ¯Ø§ÙˆÙ„
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="text-center">
                                    <h6 class="text-success">Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„</h6>
                                    <span class="badge bg-success fs-6">
                                        ${predictions.length > 0 ? 'Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ' : 'Ø§Ù†ØªØ¸Ø§Ø±'}
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="text-center">
                                    <h6 class="text-warning">ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©</h6>
                                    <span class="badge bg-warning fs-6">
                                        ${summary.riskLevel === 'Ù…Ù†Ø®ÙØ¶' ? '2-3%' : summary.riskLevel === 'Ù…ØªÙˆØ³Ø·' ? '1-2%' : '0.5-1%'}
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="text-center">
                                    <h6 class="text-info">Ø¬Ù†ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</h6>
                                    <span class="badge bg-info fs-6">
                                        ${predictions.length > 0 ? 'Ø­Ø³Ø¨ Ø§Ù„Ù‡Ø¯Ù' : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            advancedRecommendations.innerHTML = `
                ${riskManagement}
                ${predictions.length > 0 ? recommendationCards : '<div class="alert alert-info">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙˆÙ‚Ø¹Ø§Øª ÙˆØ§Ø¶Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</div>'}
                ${tradingPlan}
            `;
        }

        // Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ù…Ø³Ø­ Ø§Ù„Ø³ÙˆÙ‚
        function displayMarketScan(results) {
            const topOpportunities = results.slice(0, 10);
            
            const scanTable = topOpportunities.map((result, index) => `
                <tr class="cursor-pointer" onclick="loadSymbolAnalysis('${result.symbol}')">
                    <td>${index + 1}</td>
                    <td>
                        <strong>${result.symbol}</strong>
                        <br>
                        <small class="text-muted">${result.summary.trend}</small>
                    </td>
                    <td>
                        <div class="progress" style="height: 20px;">
                            <div class="progress-bar bg-${result.analysis.confidence > 70 ? 'success' : result.analysis.confidence > 50 ? 'warning' : 'danger'}" 
                                 style="width: ${result.analysis.confidence}%">
                                ${result.analysis.confidence}%
                            </div>
                        </div>
                    </td>
                    <td>
                        <span class="badge bg-${getRecommendationColor(result.summary.recommendation)}">
                            ${result.summary.recommendation}
                        </span>
                    </td>
                    <td>${result.summary.waveCount}</td>
                    <td>${result.summary.patternCount}</td>
                    <td>
                        <span class="badge bg-${result.summary.riskLevel === 'Ù…Ù†Ø®ÙØ¶' ? 'success' : result.summary.riskLevel === 'Ù…ØªÙˆØ³Ø·' ? 'warning' : 'danger'}">
                            ${result.summary.riskLevel}
                        </span>
                    </td>
                </tr>
            `).join('');

            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            const modalHTML = `
                <div class="modal fade" id="marketScanModal" tabindex="-1">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">
                                    <i class="fas fa-search"></i>
                                    Ù†ØªØ§Ø¦Ø¬ Ù…Ø³Ø­ Ø§Ù„Ø³ÙˆÙ‚ - Ø£ÙØ¶Ù„ ${topOpportunities.length} ÙØ±Øµ
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>#</th>
                                                <th>Ø§Ù„Ø±Ù…Ø²</th>
                                                <th>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©</th>
                                                <th>Ø§Ù„ØªÙˆØµÙŠØ©</th>
                                                <th>Ø§Ù„Ù…ÙˆØ¬Ø§Øª</th>
                                                <th>Ø§Ù„Ø£Ù†Ù…Ø§Ø·</th>
                                                <th>Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${scanTable}
                                        </tbody>
                                    </table>
                                </div>
                                
                                <div class="mt-4">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="card border-success">
                                                <div class="card-body text-center">
                                                    <h6 class="text-success">ÙØ±Øµ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø«Ù‚Ø©</h6>
                                                    <h4 class="text-success">${results.filter(r => r.analysis.confidence > 70).length}</h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="card border-warning">
                                                <div class="card-body text-center">
                                                    <h6 class="text-warning">ÙØ±Øµ Ù…ØªÙˆØ³Ø·Ø©</h6>
                                                    <h4 class="text-warning">${results.filter(r => r.analysis.confidence > 50 && r.analysis.confidence <= 70).length}</h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="card border-info">
                                                <div class="card-body text-center">
                                                    <h6 class="text-info">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¬Ø§Øª</h6>
                                                    <h4 class="text-info">${results.reduce((sum, r) => sum + r.summary.waveCount, 0)}</h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="card border-primary">
                                                <div class="card-body text-center">
                                                    <h6 class="text-primary">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ù…Ø§Ø·</h6>
                                                    <h4 class="text-primary">${results.reduce((sum, r) => sum + r.summary.patternCount, 0)}</h4>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
                                <button type="button" class="btn btn-primary" onclick="exportScanResults()">ØªØµØ¯ÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
            const modal = new bootstrap.Modal(document.getElementById('marketScanModal'));
            modal.show();
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
            document.getElementById('marketScanModal').addEventListener('hidden.bs.modal', function () {
                this.remove();
            });
        }

        // ØªØ­Ù…ÙŠÙ„ ØªØ­Ù„ÙŠÙ„ Ø±Ù…Ø² Ù…Ø¹ÙŠÙ† Ù…Ù† Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø³Ø­
        async function loadSymbolAnalysis(symbol) {
            document.getElementById('symbolInput').value = symbol;
            const modal = bootstrap.Modal.getInstance(document.getElementById('marketScanModal'));
            modal.hide();
            
            setTimeout(() => {
                analyzeAdvanced();
            }, 500);
        }

        // ØªØµØ¯ÙŠØ± Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø³Ø­
        function exportScanResults() {
            const results = app.analysisHistory.filter(r => r.success);
            const csvContent = generateCSVReport(results);
            downloadCSV(csvContent, `elliott-wave-scan-${new Date().toISOString().split('T')[0]}.csv`);
        }

        // ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ± CSV
        function generateCSVReport(results) {
            const headers = ['Ø§Ù„Ø±Ù…Ø²', 'Ø§Ù„ÙØªØ±Ø©', 'Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©', 'Ø§Ù„Ø§ØªØ¬Ø§Ù‡', 'Ø§Ù„ØªÙˆØµÙŠØ©', 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¬Ø§Øª', 'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù†Ù…Ø§Ø·', 'Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©'];
            const rows = results.map(r => [
                r.symbol,
                r.interval,
                r.analysis.confidence,
                r.summary.trend,
                r.summary.recommendation,
                r.summary.waveCount,
                r.summary.patternCount,
                r.summary.riskLevel
            ]);
            
            return [headers, ...rows].map(row => row.join(',')).join('\n');
        }

        // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù CSV
        function downloadCSV(content, filename) {
            const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
        function showLoading(text = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...') {
            document.getElementById('loadingText').textContent = text;
            loadingBar.style.display = 'block';
        }

        function hideLoading() {
            loadingBar.style.display = 'none';
        }

        function showError(message) {
            analysisDetails.innerHTML = `
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Ø®Ø·Ø£:</strong> ${message}
                </div>
            `;
        }

        function getConfidenceClass(confidence) {
            if (confidence > 70) return 'high-confidence';
            if (confidence > 50) return 'medium-confidence';
            return 'low-confidence';
        }

        function getRecommendationColor(recommendation) {
            if (recommendation.includes('Ø´Ø±Ø§Ø¡')) return 'success';
            if (recommendation.includes('Ø¨ÙŠØ¹')) return 'danger';
            if (recommendation.includes('Ø§Ù†ØªØ¸Ø§Ø±')) return 'warning';
            return 'secondary';
        }

        function getRiskAdvice(riskLevel) {
            const advice = {
                'Ù…Ù†Ø®ÙØ¶': 'ÙŠÙ…ÙƒÙ† Ø²ÙŠØ§Ø¯Ø© Ø­Ø¬Ù… Ø§Ù„Ù…Ø±ÙƒØ² Ù…Ø¹ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ù„Ø³ÙˆÙ‚',
                'Ù…ØªÙˆØ³Ø·': 'Ø§Ø³ØªØ®Ø¯Ù… Ø­Ø¬Ù… Ù…Ø±ÙƒØ² Ù…Ø¹ØªØ¯Ù„ Ù…Ø¹ ÙˆØ¶Ø¹ ÙˆÙ‚Ù Ø®Ø³Ø§Ø±Ø© Ù…Ø­ÙƒÙ…',
                'Ø¹Ø§Ù„ÙŠ': 'ØªØ¯Ø§ÙˆÙ„ Ø¨Ø­Ø°Ø± Ø´Ø¯ÙŠØ¯ Ù…Ø¹ Ø­Ø¬Ù… Ù…Ø±ÙƒØ² ØµØºÙŠØ± ÙˆÙˆÙ‚Ù Ø®Ø³Ø§Ø±Ø© Ù‚Ø±ÙŠØ¨'
            };
            return advice[riskLevel] || 'ØªØ¯Ø§ÙˆÙ„ Ø¨Ø­Ø°Ø±';
        }

        // Ø±Ø¨Ø· Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        analyzeBtn.addEventListener('click', analyzeAdvanced);
        scanBtn.addEventListener('click', scanMarket);

        // ØªØ­Ù„ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            // ØªØ­Ù„ÙŠÙ„ BTC Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
            setTimeout(() => {
                analyzeAdvanced();
            }, 1000);
        });

        // Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                analyzeAdvanced();
            }
            if (e.ctrlKey && e.shiftKey && e.key === 'S') {
                e.preventDefault();
                scanMarket();
            }
        });

                // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        function saveSettings() {
            const settings = {
                defaultSymbol: document.getElementById('symbolInput').value,
                defaultInterval: document.getElementById('intervalSelect').value,
                defaultLimit: document.getElementById('limitSelect').value,
                theme: document.body.classList.contains('dark-theme') ? 'dark' : 'light'
            };
            localStorage.setItem('elliottWaveSettings', JSON.stringify(settings));
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        function loadSettings() {
            const savedSettings = localStorage.getItem('elliottWaveSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                document.getElementById('symbolInput').value = settings.defaultSymbol || 'BTCUSDT';
                document.getElementById('intervalSelect').value = settings.defaultInterval || '4h';
                document.getElementById('limitSelect').value = settings.defaultLimit || '200';
                
                if (settings.theme === 'dark') {
                    toggleTheme();
                }
            }
        }

        // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¸Ù‡Ø±
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            
            // ØªØ­Ø¯ÙŠØ« Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø¸Ù‡Ø±
            const themeIcon = document.querySelector('#themeToggle i');
            if (themeIcon) {
                themeIcon.className = isDark ? 'fas fa-sun' : 'fas fa-moon';
            }
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø¨Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            if (app.chart) {
                updateChartTheme(isDark);
            }
            
            saveSettings();
        }

        // ØªØ­Ø¯ÙŠØ« Ù…Ø¸Ù‡Ø± Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
        function updateChartTheme(isDark) {
            const chart = app.chart;
            if (!chart) return;
            
            const backgroundColor = isDark ? '#2d3748' : '#ffffff';
            const textColor = isDark ? '#e2e8f0' : '#2d3748';
            const gridColor = isDark ? '#4a5568' : '#e2e8f0';
            
            chart.options.plugins.legend.labels.color = textColor;
            chart.options.scales.x.ticks.color = textColor;
            chart.options.scales.y.ticks.color = textColor;
            chart.options.scales.x.grid.color = gridColor;
            chart.options.scales.y.grid.color = gridColor;
            
            chart.update();
        }

        // Ø¥Ø¶Ø§ÙØ© ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ø®ØµØµØ©
        class AlertManager {
            constructor() {
                this.alerts = JSON.parse(localStorage.getItem('elliottWaveAlerts') || '[]');
                this.checkInterval = null;
            }

            addAlert(symbol, condition, value, message) {
                const alert = {
                    id: Date.now(),
                    symbol,
                    condition, // 'above', 'below', 'pattern', 'wave'
                    value,
                    message,
                    active: true,
                    created: new Date().toISOString()
                };
                
                this.alerts.push(alert);
                this.saveAlerts();
                this.startChecking();
                
                return alert.id;
            }

            removeAlert(id) {
                this.alerts = this.alerts.filter(alert => alert.id !== id);
                this.saveAlerts();
                
                if (this.alerts.length === 0) {
                    this.stopChecking();
                }
            }

            async checkAlerts() {
                for (const alert of this.alerts.filter(a => a.active)) {
                    try {
                        const result = await app.analyzeSymbol(alert.symbol, '1h', 50);
                        if (result.success) {
                            const triggered = this.evaluateCondition(alert, result);
                            if (triggered) {
                                this.triggerAlert(alert);
                                alert.active = false;
                            }
                        }
                    } catch (error) {
                        console.error(`Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ ${alert.id}:`, error);
                    }
                }
                
                this.saveAlerts();
            }

            evaluateCondition(alert, result) {
                const currentPrice = result.data[result.data.length - 1].close;
                
                switch (alert.condition) {
                    case 'above':
                        return currentPrice > alert.value;
                    case 'below':
                        return currentPrice < alert.value;
                    case 'pattern':
                        return result.analysis.patterns.some(p => p.type === alert.value);
                    case 'wave':
                        return result.analysis.waves.some(w => w.label === alert.value);
                    case 'confidence':
                        return result.analysis.confidence > alert.value;
                    default:
                        return false;
                }
            }

            triggerAlert(alert) {
                // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ØªØµÙØ­
                if (Notification.permission === 'granted') {
                    new Notification('ØªÙ†Ø¨ÙŠÙ‡ Elliott Wave', {
                        body: alert.message,
                        icon: '/favicon.ico'
                    });
                }
                
                // Ø¥Ø´Ø¹Ø§Ø± ÙÙŠ Ø§Ù„ØµÙØ­Ø©
                this.showPageNotification(alert);
                
                // ØµÙˆØª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
                this.playAlertSound();
            }

            showPageNotification(alert) {
                const notification = document.createElement('div');
                notification.className = 'alert alert-warning alert-dismissible fade show position-fixed';
                notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; max-width: 400px;';
                notification.innerHTML = `
                    <strong>${alert.symbol}</strong><br>
                    ${alert.message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                `;
                
                document.body.appendChild(notification);
                
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø¨Ø¹Ø¯ 10 Ø«ÙˆØ§Ù†
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 10000);
            }

            playAlertSound() {
                const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT');
                audio.play().catch(() => {}); // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
            }

            startChecking() {
                if (this.checkInterval) return;
                
                this.checkInterval = setInterval(() => {
                    this.checkAlerts();
                }, 60000); // ÙØ­Øµ ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
            }

            stopChecking() {
                if (this.checkInterval) {
                    clearInterval(this.checkInterval);
                    this.checkInterval = null;
                }
            }

            saveAlerts() {
                localStorage.setItem('elliottWaveAlerts', JSON.stringify(this.alerts));
            }

            getActiveAlerts() {
                return this.alerts.filter(a => a.active);
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
        const alertManager = new AlertManager();

        // ÙˆØ§Ø¬Ù‡Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
        function showAlertManager() {
            const modalHTML = `
                <div class="modal fade" id="alertModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">
                                    <i class="fas fa-bell"></i>
                                    Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <button class="btn btn-primary" onclick="showAddAlertForm()">
                                            <i class="fas fa-plus"></i>
                                            Ø¥Ø¶Ø§ÙØ© ØªÙ†Ø¨ÙŠÙ‡ Ø¬Ø¯ÙŠØ¯
                                        </button>
                                    </div>
                                    <div class="col-md-6 text-end">
                                        <span class="badge bg-info">
                                            Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©: ${alertManager.getActiveAlerts().length}
                                        </span>
                                    </div>
                                </div>
                                
                                <div id="alertsList">
                                    ${renderAlertsList()}
                                </div>
                                
                                <div id="addAlertForm" style="display: none;">
                                    ${renderAddAlertForm()}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHTML);
            const modal = new bootstrap.Modal(document.getElementById('alertModal'));
            modal.show();
            
            document.getElementById('alertModal').addEventListener('hidden.bs.modal', function () {
                this.remove();
            });
        }

        function renderAlertsList() {
            const alerts = alertManager.alerts;
            
            if (alerts.length === 0) {
                return '<div class="alert alert-info">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©</div>';
            }
            
            return alerts.map(alert => `
                <div class="card mb-2 ${alert.active ? '' : 'opacity-50'}">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6 class="card-title">
                                    ${alert.symbol}
                                    <span class="badge bg-${alert.active ? 'success' : 'secondary'}">
                                        ${alert.active ? 'Ù†Ø´Ø·' : 'Ù…ÙƒØªÙ…Ù„'}
                                    </span>
                                </h6>
                                <p class="card-text">${alert.message}</p>
                                <small class="text-muted">
                                    ${getConditionText(alert)} | 
                                    ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: ${new Date(alert.created).toLocaleDateString('ar-SA')}
                                </small>
                            </div>
                            <div>
                                <button class="btn btn-sm btn-danger" onclick="removeAlert(${alert.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderAddAlertForm() {
            return `
                <div class="card">
                    <div class="card-header">
                        <h6>Ø¥Ø¶Ø§ÙØ© ØªÙ†Ø¨ÙŠÙ‡ Ø¬Ø¯ÙŠØ¯</h6>
                    </div>
                    <div class="card-body">
                        <form id="alertForm">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label">Ø±Ù…Ø² Ø§Ù„Ø¹Ù…Ù„Ø©</label>
                                    <input type="text" class="form-control" id="alertSymbol" placeholder="BTCUSDT" required>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡</label>
                                    <select class="form-select" id="alertCondition" onchange="updateAlertValueField()" required>
                                        <option value="above">Ø§Ù„Ø³Ø¹Ø± Ø£Ø¹Ù„Ù‰ Ù…Ù†</option>
                                        <option value="below">Ø§Ù„Ø³Ø¹Ø± Ø£Ù‚Ù„ Ù…Ù†</option>
                                        <option value="confidence">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø© Ø£Ø¹Ù„Ù‰ Ù…Ù†</option>
                                        <option value="pattern">Ø§ÙƒØªØ´Ø§Ù Ù†Ù…Ø·</option>
                                        <option value="wave">Ø§ÙƒØªØ´Ø§Ù Ù…ÙˆØ¬Ø©</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Ø§Ù„Ù‚ÙŠÙ…Ø©</label>
                                <input type="number" class="form-control" id="alertValue" step="0.0001" required>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡</label>
                                <textarea class="form-control" id="alertMessage" rows="2" placeholder="ÙˆØµÙ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡..." required></textarea>
                            </div>
                            
                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save"></i>
                                    Ø­ÙØ¸ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="hideAddAlertForm()">
                                    Ø¥Ù„ØºØ§Ø¡
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
        }

        function showAddAlertForm() {
            document.getElementById('addAlertForm').style.display = 'block';
            document.getElementById('alertSymbol').value = document.getElementById('symbolInput').value;
        }

        function hideAddAlertForm() {
            document.getElementById('addAlertForm').style.display = 'none';
        }

        function updateAlertValueField() {
            const condition = document.getElementById('alertCondition').value;
            const valueField = document.getElementById('alertValue');
            
            switch (condition) {
                case 'confidence':
                    valueField.placeholder = '70';
                    valueField.max = '100';
                    valueField.min = '0';
                    break;
                case 'above':
                case 'below':
                    valueField.placeholder = '50000';
                    valueField.removeAttribute('max');
                    valueField.min = '0';
                    break;
                default:
                    valueField.placeholder = '';
            }
        }

              function getConditionText(alert) {
            const conditions = {
                'above': `Ø§Ù„Ø³Ø¹Ø± > ${alert.value}`,
                'below': `Ø§Ù„Ø³Ø¹Ø± < ${alert.value}`,
                'confidence': `Ø§Ù„Ø«Ù‚Ø© > ${alert.value}%`,
                'pattern': `Ù†Ù…Ø·: ${alert.value}`,
                'wave': `Ù…ÙˆØ¬Ø©: ${alert.value}`
            };
            return conditions[alert.condition] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }

        function removeAlert(id) {
            alertManager.removeAlert(id);
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
            document.getElementById('alertsList').innerHTML = renderAlertsList();
        }

        // Ù…Ø¹Ø§Ù„Ø¬ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
        document.addEventListener('submit', function(e) {
            if (e.target.id === 'alertForm') {
                e.preventDefault();
                
                const symbol = document.getElementById('alertSymbol').value.toUpperCase();
                const condition = document.getElementById('alertCondition').value;
                const value = parseFloat(document.getElementById('alertValue').value);
                const message = document.getElementById('alertMessage').value;
                
                alertManager.addAlert(symbol, condition, value, message);
                
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                hideAddAlertForm();
                document.getElementById('alertsList').innerHTML = renderAlertsList();
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
                const successAlert = document.createElement('div');
                successAlert.className = 'alert alert-success alert-dismissible fade show';
                successAlert.innerHTML = `
                    ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø¨Ù†Ø¬Ø§Ø­!
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                `;
                document.querySelector('#alertModal .modal-body').prepend(successAlert);
                
                setTimeout(() => successAlert.remove(), 3000);
            }
        });

        // Ø·Ù„Ø¨ Ø¥Ø°Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        new Notification('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª', {
                            body: 'Ø³ØªØªÙ„Ù‚Ù‰ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù‚Ù‚ Ø´Ø±ÙˆØ· Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª',
                            icon: '/favicon.ico'
                        });
                    }
                });
            }
        }

        // Ø¥Ø¶Ø§ÙØ© Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
        class TechnicalIndicators {
            static RSI(prices, period = 14) {
                const gains = [];
                const losses = [];
                
                for (let i = 1; i < prices.length; i++) {
                    const change = prices[i] - prices[i - 1];
                    gains.push(change > 0 ? change : 0);
                    losses.push(change < 0 ? Math.abs(change) : 0);
                }
                
                const rsi = [];
                for (let i = period - 1; i < gains.length; i++) {
                    const avgGain = gains.slice(i - period + 1, i + 1).reduce((a, b) => a + b) / period;
                    const avgLoss = losses.slice(i - period + 1, i + 1).reduce((a, b) => a + b) / period;
                    
                    if (avgLoss === 0) {
                        rsi.push(100);
                    } else {
                        const rs = avgGain / avgLoss;
                        rsi.push(100 - (100 / (1 + rs)));
                    }
                }
                
                return rsi;
            }

            static MACD(prices, fastPeriod = 12, slowPeriod = 26, signalPeriod = 9) {
                const emaFast = this.EMA(prices, fastPeriod);
                const emaSlow = this.EMA(prices, slowPeriod);
                
                const macdLine = [];
                for (let i = 0; i < Math.min(emaFast.length, emaSlow.length); i++) {
                    macdLine.push(emaFast[i] - emaSlow[i]);
                }
                
                const signalLine = this.EMA(macdLine, signalPeriod);
                const histogram = [];
                
                for (let i = 0; i < Math.min(macdLine.length, signalLine.length); i++) {
                    histogram.push(macdLine[i] - signalLine[i]);
                }
                
                return {
                    macd: macdLine,
                    signal: signalLine,
                    histogram: histogram
                };
            }

            static EMA(prices, period) {
                const multiplier = 2 / (period + 1);
                const ema = [prices[0]];
                
                for (let i = 1; i < prices.length; i++) {
                    ema.push((prices[i] * multiplier) + (ema[i - 1] * (1 - multiplier)));
                }
                
                return ema;
            }

            static BollingerBands(prices, period = 20, stdDev = 2) {
                const sma = this.SMA(prices, period);
                const bands = { upper: [], middle: [], lower: [] };
                
                for (let i = period - 1; i < prices.length; i++) {
                    const slice = prices.slice(i - period + 1, i + 1);
                    const mean = sma[i - period + 1];
                    const variance = slice.reduce((sum, price) => sum + Math.pow(price - mean, 2), 0) / period;
                    const standardDeviation = Math.sqrt(variance);
                    
                    bands.middle.push(mean);
                    bands.upper.push(mean + (standardDeviation * stdDev));
                    bands.lower.push(mean - (standardDeviation * stdDev));
                }
                
                return bands;
            }

            static SMA(prices, period) {
                const sma = [];
                for (let i = period - 1; i < prices.length; i++) {
                    const sum = prices.slice(i - period + 1, i + 1).reduce((a, b) => a + b);
                    sma.push(sum / period);
                }
                return sma;
            }

            static StochasticOscillator(highs, lows, closes, kPeriod = 14, dPeriod = 3) {
                const k = [];
                
                for (let i = kPeriod - 1; i < closes.length; i++) {
                    const highestHigh = Math.max(...highs.slice(i - kPeriod + 1, i + 1));
                    const lowestLow = Math.min(...lows.slice(i - kPeriod + 1, i + 1));
                    const currentClose = closes[i];
                    
                    k.push(((currentClose - lowestLow) / (highestHigh - lowestLow)) * 100);
                }
                
                const d = this.SMA(k, dPeriod);
                
                return { k, d };
            }
        }

        // ØªØ­Ø³ÙŠÙ† Ù…Ø­Ù„Ù„ Elliott Wave Ø¨Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ÙÙ†ÙŠØ©
        class EnhancedElliottWaveAnalyzer extends AdvancedElliottWaveAnalyzer {
            analyzeData(data) {
                const baseAnalysis = super.analyzeData(data);
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ÙÙ†ÙŠØ©
                const prices = data.map(d => d.close);
                const highs = data.map(d => d.high);
                const lows = data.map(d => d.low);
                
                const indicators = {
                    rsi: TechnicalIndicators.RSI(prices),
                    macd: TechnicalIndicators.MACD(prices),
                    bollinger: TechnicalIndicators.BollingerBands(prices),
                    stochastic: TechnicalIndicators.StochasticOscillator(highs, lows, prices)
                };
                
                // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª
                const signals = this.analyzeSignals(indicators, baseAnalysis);
                
                return {
                    ...baseAnalysis,
                    indicators,
                    signals,
                    enhancedConfidence: this.calculateEnhancedConfidence(baseAnalysis, signals)
                };
            }

            analyzeSignals(indicators, baseAnalysis) {
                const signals = [];
                
                // Ø¥Ø´Ø§Ø±Ø§Øª RSI
                const currentRSI = indicators.rsi[indicators.rsi.length - 1];
                if (currentRSI > 70) {
                    signals.push({
                        type: 'overbought',
                        indicator: 'RSI',
                        value: currentRSI,
                        signal: 'Ø¨ÙŠØ¹',
                        strength: Math.min((currentRSI - 70) / 10, 1)
                    });
                } else if (currentRSI < 30) {
                    signals.push({
                        type: 'oversold',
                        indicator: 'RSI',
                        value: currentRSI,
                        signal: 'Ø´Ø±Ø§Ø¡',
                        strength: Math.min((30 - currentRSI) / 10, 1)
                    });
                }
                
                // Ø¥Ø´Ø§Ø±Ø§Øª MACD
                const macd = indicators.macd;
                const currentMACD = macd.macd[macd.macd.length - 1];
                const currentSignal = macd.signal[macd.signal.length - 1];
                const previousMACD = macd.macd[macd.macd.length - 2];
                const previousSignal = macd.signal[macd.signal.length - 2];
                
                if (previousMACD <= previousSignal && currentMACD > currentSignal) {
                    signals.push({
                        type: 'bullish_crossover',
                        indicator: 'MACD',
                        signal: 'Ø´Ø±Ø§Ø¡',
                        strength: Math.min(Math.abs(currentMACD - currentSignal) / Math.abs(currentMACD), 1)
                    });
                } else if (previousMACD >= previousSignal && currentMACD < currentSignal) {
                    signals.push({
                        type: 'bearish_crossover',
                        indicator: 'MACD',
                        signal: 'Ø¨ÙŠØ¹',
                        strength: Math.min(Math.abs(currentMACD - currentSignal) / Math.abs(currentMACD), 1)
                    });
                }
                
                // Ø¥Ø´Ø§Ø±Ø§Øª Bollinger Bands
                const bollinger = indicators.bollinger;
                const currentPrice = baseAnalysis.trend.currentPrice;
                const upperBand = bollinger.upper[bollinger.upper.length - 1];
                const lowerBand = bollinger.lower[bollinger.lower.length - 1];
                
                if (currentPrice > upperBand) {
                    signals.push({
                        type: 'price_above_upper_band',
                        indicator: 'Bollinger Bands',
                        signal: 'Ø¨ÙŠØ¹ Ù…Ø­ØªÙ…Ù„',
                        strength: Math.min((currentPrice - upperBand) / upperBand, 1)
                    });
                } else if (currentPrice < lowerBand) {
                    signals.push({
                        type: 'price_below_lower_band',
                        indicator: 'Bollinger Bands',
                        signal: 'Ø´Ø±Ø§Ø¡ Ù…Ø­ØªÙ…Ù„',
                        strength: Math.min((lowerBand - currentPrice) / lowerBand, 1)
                    });
                }
                
                return signals;
            }

            calculateEnhancedConfidence(baseAnalysis, signals) {
                let enhancedConfidence = baseAnalysis.confidence;
                
                // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø«Ù‚Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª
                const bullishSignals = signals.filter(s => s.signal.includes('Ø´Ø±Ø§Ø¡')).length;
                const bearishSignals = signals.filter(s => s.signal.includes('Ø¨ÙŠØ¹')).length;
                
                if (baseAnalysis.trend.direction.includes('bullish') && bullishSignals > bearishSignals) {
                    enhancedConfidence += 10;
                } else if (baseAnalysis.trend.direction.includes('bearish') && bearishSignals > bullishSignals) {
                    enhancedConfidence += 10;
                } else if (bullishSignals > 0 && bearishSignals > 0) {
                    enhancedConfidence -= 5; // Ø¥Ø´Ø§Ø±Ø§Øª Ù…ØªØ¶Ø§Ø±Ø¨Ø©
                }
                
                return Math.min(Math.max(enhancedConfidence, 0), 100);
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ù…Ø­Ø³Ù†
        app.analyzer = new EnhancedElliottWaveAnalyzer();

        // Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ø¬Ù‡Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ÙÙ†ÙŠØ©
        function displayTechnicalIndicators(indicators, signals) {
            const indicatorsHTML = `
                <div class="card mb-3">
                    <div class="card-header">
                        <h6><i class="fas fa-chart-bar"></i> Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ÙÙ†ÙŠØ©</h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="indicator-item">
                                    <strong>RSI (14):</strong>
                                    <span class="badge bg-${getRSIColor(indicators.rsi[indicators.rsi.length - 1])}">
                                        ${indicators.rsi[indicators.rsi.length - 1].toFixed(2)}
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="indicator-item">
                                    <strong>MACD:</strong>
                                    <span class="badge bg-${indicators.macd.histogram[indicators.macd.histogram.length - 1] > 0 ? 'success' : 'danger'}">
                                        ${indicators.macd.macd[indicators.macd.macd.length - 1].toFixed(4)}
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-2">
                            <div class="col-md-12">
                                <strong>Bollinger Bands:</strong>
                                <div class="d-flex gap-2">
                                    <small>Ø§Ù„Ø¹Ù„ÙˆÙŠ: ${indicators.bollinger.upper[indicators.bollinger.upper.length - 1].toFixed(4)}</small>
                                    <small>Ø§Ù„ÙˆØ³Ø·: ${indicators.bollinger.middle[indicators.bollinger.middle.length - 1].toFixed(4)}</small>
                                    <small>Ø§Ù„Ø³ÙÙ„ÙŠ: ${indicators.bollinger.lower[indicators.bollinger.lower.length - 1].toFixed(4)}</small>
                                </div>
                            </div>
                        </div>
                        </div>
                        
                        <div class="row mt-2">
                            <div class="col-md-6">
                                <div class="indicator-item">
                                    <strong>Stochastic %K:</strong>
                                    <span class="badge bg-${getStochasticColor(indicators.stochastic.k[indicators.stochastic.k.length - 1])}">
                                        ${indicators.stochastic.k[indicators.stochastic.k.length - 1].toFixed(2)}
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="indicator-item">
                                    <strong>Stochastic %D:</strong>
                                    <span class="badge bg-${getStochasticColor(indicators.stochastic.d[indicators.stochastic.d.length - 1])}">
                                        ${indicators.stochastic.d[indicators.stochastic.d.length - 1].toFixed(2)}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-3">
                    <div class="card-header">
                        <h6><i class="fas fa-signal"></i> Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„ÙÙ†ÙŠØ©</h6>
                    </div>
                    <div class="card-body">
                        ${signals.length > 0 ? renderSignals(signals) : '<div class="alert alert-info">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø§Ø±Ø§Øª ÙˆØ§Ø¶Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</div>'}
                    </div>
                </div>
            `;
            
            return indicatorsHTML;
        }

        function renderSignals(signals) {
            return signals.map(signal => `
                <div class="alert alert-${getSignalAlertClass(signal.signal)} d-flex justify-content-between align-items-center">
                    <div>
                        <strong>${signal.indicator}:</strong> ${signal.signal}
                        ${signal.value ? `(${signal.value.toFixed(2)})` : ''}
                    </div>
                    <div>
                        <div class="progress" style="width: 100px; height: 20px;">
                            <div class="progress-bar bg-${getSignalProgressColor(signal.signal)}" 
                                 style="width: ${(signal.strength * 100).toFixed(0)}%">
                                ${(signal.strength * 100).toFixed(0)}%
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getRSIColor(rsi) {
            if (rsi > 70) return 'danger';
            if (rsi < 30) return 'success';
            return 'secondary';
        }

        function getStochasticColor(value) {
            if (value > 80) return 'danger';
            if (value < 20) return 'success';
            return 'secondary';
        }

        function getSignalAlertClass(signal) {
            if (signal.includes('Ø´Ø±Ø§Ø¡')) return 'success';
            if (signal.includes('Ø¨ÙŠØ¹')) return 'danger';
            return 'warning';
        }

        function getSignalProgressColor(signal) {
            if (signal.includes('Ø´Ø±Ø§Ø¡')) return 'success';
            if (signal.includes('Ø¨ÙŠØ¹')) return 'danger';
            return 'warning';
        }

        // ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ù„ØªØ´Ù…Ù„ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ÙÙ†ÙŠØ©
        function displayAnalysisResults(result) {
            const { analysis, summary } = result;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
            analysisDetails.innerHTML = `
                <div class="card mb-3 ${getConfidenceClass(analysis.enhancedConfidence || analysis.confidence)}">
                    <div class="card-header">
                        <h5>Ù…Ù„Ø®Øµ Ø§Ù„ØªØ­Ù„ÙŠÙ„</h5>
                    </div>
                    <div class="card-body">
                        <div class="row text-center mb-3">
                            <div class="col-4">
                                <strong>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©:</strong><br>
                                <div class="progress mt-2">
                                    <div class="progress-bar bg-${analysis.enhancedConfidence > 70 ? 'success' : analysis.enhancedConfidence > 50 ? 'warning' : 'danger'}" 
                                         style="width: ${analysis.enhancedConfidence || analysis.confidence}%">
                                        ${(analysis.enhancedConfidence || analysis.confidence).toFixed(0)}%
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <strong>Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø¹Ø§Ù…:</strong><br>
                                <span class="badge bg-${analysis.trend.direction.includes('bullish') ? 'success' : 'danger'} fs-6">
                                    ${analysis.trend.direction}
                                </span>
                            </div>
                            <div class="col-4">
                                <strong>Ù‚ÙˆØ© Ø§Ù„Ø§ØªØ¬Ø§Ù‡:</strong><br>
                                <span class="badge bg-info fs-6">${analysis.trend.strength}%</span>
                            </div>
                        </div>
                        
                        <div class="row text-center">
                            <div class="col-6">
                                <strong>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¬Ø§Øª:</strong><br>
                                <span class="badge bg-success">${summary.waveCount}</span>
                            </div>
                            <div class="col-6">
                                <strong>Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙƒØªØ´ÙØ©:</strong><br>
                                <span class="badge bg-warning">${summary.patternCount}</span>
                            </div>
                        </div>
                        <hr>
                        <div class="text-center">
                            <strong>Ø§Ù„ØªÙˆØµÙŠØ©:</strong><br>
                            <span class="badge bg-${getRecommendationColor(summary.recommendation)} fs-6">
                                ${summary.recommendation}
                            </span>
                        </div>
                        <div class="mt-2 text-center">
                            <small class="text-muted">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©: ${summary.riskLevel}</small>
                        </div>
                    </div>
                </div>
                
                ${analysis.indicators ? displayTechnicalIndicators(analysis.indicators, analysis.signals) : ''}
                
                <div class="card mb-3">
                    <div class="card-header">
                        <h6>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡</h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-2">
                            <small>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ:</small>
                            <strong>${analysis.trend.currentPrice.toFixed(4)}</strong>
                        </div>
                        <div class="mb-2">
                            <small>Ø§Ù„Ù…ØªÙˆØ³Ø· Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰:</small>
                            <span class="${analysis.trend.currentPrice > analysis.trend.shortMA ? 'text-success' : 'text-danger'}">
                                ${analysis.trend.shortMA.toFixed(4)}
                            </span>
                        </div>
                        <div class="mb-2">
                            <small>Ø§Ù„Ù…ØªÙˆØ³Ø· Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø¯Ù‰:</small>
                            <span class="${analysis.trend.shortMA > analysis.trend.mediumMA ? 'text-success' : 'text-danger'}">
                                ${analysis.trend.mediumMA.toFixed(4)}
                            </span>
                        </div>
                        <div class="mb-2">
                            <small>Ø§Ù„Ù…ØªÙˆØ³Ø· Ø·ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¯Ù‰:</small>
                            <span class="${analysis.trend.mediumMA > analysis.trend.longMA ? 'text-success' : 'text-danger'}">
                                ${analysis.trend.longMA.toFixed(4)}
                            </span>
                        </div>
                        <div class="progress mt-3">
                            <div class="progress-bar bg-${analysis.trend.strength > 70 ? 'success' : analysis.trend.strength > 40 ? 'warning' : 'danger'}" 
                                 style="width: ${analysis.trend.strength}%">
                                Ù‚ÙˆØ© Ø§Ù„Ø§ØªØ¬Ø§Ù‡: ${analysis.trend.strength}%
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h6>Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø©</h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-6">
                                <strong class="text-danger">Ù…Ù‚Ø§ÙˆÙ…Ø©:</strong><br>
                                ${analysis.support_resistance.resistance.slice(0, 3).map(r => 
                                    `<small class="d-block">${r.toFixed(4)}</small>`
                                ).join('')}
                            </div>
                            <div class="col-6">
                                <strong class="text-success">Ø¯Ø¹Ù…:</strong><br>
                                ${analysis.support_resistance.support.slice(0, 3).map(s => 
                                    `<small class="d-block">${s.toFixed(4)}</small>`
                                ).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Ø¹Ø±Ø¶ Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØªÙØ§ØµÙŠÙ„
            displayWaveDetails(analysis.waves);
            displayFibonacciLevels(analysis.fibonacci);
            displayDetectedPatterns(analysis.patterns);
            displayAdvancedRecommendations(analysis.predictions, summary);
        }

        // Ø¥Ø¶Ø§ÙØ© Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
        function addControlButtons() {
            const controlsHTML = `
                <div class="row mb-3">
                    <div class="col-md-12">
                        <div class="btn-group me-2" role="group">
                            <button type="button" class="btn btn-outline-primary" onclick="toggleTheme()" id="themeToggle">
                                <i class="fas fa-moon"></i>
                            </button>
                            <button type="button" class="btn btn-outline-info" onclick="showAlertManager()">
                                <i class="fas fa-bell"></i>
                                Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
                            </button>
                            <button type="button" class="btn btn-outline-success" onclick="exportAnalysis()">
                                <i class="fas fa-download"></i>
                                ØªØµØ¯ÙŠØ±
                            </button>
                        </div>
                        
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-outline-warning" onclick="showSettings()">
                                <i class="fas fa-cog"></i>
                                Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                            </button>
                            <button type="button" class="btn btn-outline-secondary" onclick="showHelp()">
                                <i class="fas fa-question-circle"></i>
                                Ù…Ø³Ø§Ø¹Ø¯Ø©
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.querySelector('.container').insertAdjacentHTML('afterbegin', controlsHTML);
        }

        // ØªØµØ¯ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„
        function exportAnalysis() {
            const lastAnalysis = app.analysisHistory[app.analysisHistory.length - 1];
            if (!lastAnalysis) {
                alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ­Ù„ÙŠÙ„ Ù„Ù„ØªØµØ¯ÙŠØ±');
                return;
            }
            
            const exportData = {
                symbol: lastAnalysis.symbol,
                interval: lastAnalysis.interval,
                timestamp: new Date().toISOString(),
                analysis: lastAnalysis.analysis,
                summary: lastAnalysis.summary
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `elliott-wave-analysis-${lastAnalysis.symbol}-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function showSettings() {
            const settingsHTML = `
                <div class="modal fade" id="settingsModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">
                                    <i class="fas fa-cog"></i>
                                    Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="settingsForm">
                                    <div class="mb-3">
                                        <label class="form-label">Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</label>
                                        <input type="text" class="form-control" id="defaultSymbol" value="${document.getElementById('symbolInput').value}">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</label>
                                        <select class="form-select" id="defaultInterval">
                                            <option value="1h">Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©</option>
                                            <option value="4h" selected>4 Ø³Ø§Ø¹Ø§Øª</option>
                                            <option value="1d">ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯</option>
                                            <option value="1w">Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ù…ÙˆØ¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</label>
                                        <select class="form-select" id="defaultLimit">
                                            <option value="100">100</option>
                                            <option value="200" selected>200</option>
                                            <option value="500">500</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="autoRefresh">
                                            <label class="form-check-label" for="autoRefresh">
                                                Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚)
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="soundAlerts">
                                            <label class="form-check-label" for="soundAlerts">
                                                                                            <label class="form-check-label" for="soundAlerts">
                                                ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Ø­Ø³Ø§Ø³ÙŠØ© Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ù…ÙˆØ¬Ø§Øª</label>
                                        <input type="range" class="form-range" id="waveSensitivity" min="1" max="10" value="5">
                                        <div class="d-flex justify-content-between">
                                            <small>Ù…Ù†Ø®ÙØ¶Ø©</small>
                                            <small>Ø¹Ø§Ù„ÙŠØ©</small>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø© Ø§Ù„Ø£Ø¯Ù†Ù‰</label>
                                        <input type="range" class="form-range" id="minConfidence" min="30" max="90" value="50">
                                        <div class="d-flex justify-content-between">
                                            <small>30%</small>
                                            <small>90%</small>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                                <button type="button" class="btn btn-primary" onclick="saveUserSettings()">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', settingsHTML);
            const modal = new bootstrap.Modal(document.getElementById('settingsModal'));
            modal.show();
            
            document.getElementById('settingsModal').addEventListener('hidden.bs.modal', function () {
                this.remove();
            });
        }

        // Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function saveUserSettings() {
            const settings = {
                defaultSymbol: document.getElementById('defaultSymbol').value,
                defaultInterval: document.getElementById('defaultInterval').value,
                defaultLimit: document.getElementById('defaultLimit').value,
                autoRefresh: document.getElementById('autoRefresh').checked,
                soundAlerts: document.getElementById('soundAlerts').checked,
                waveSensitivity: document.getElementById('waveSensitivity').value,
                minConfidence: document.getElementById('minConfidence').value
            };
            
            localStorage.setItem('elliottWaveUserSettings', JSON.stringify(settings));
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            document.getElementById('symbolInput').value = settings.defaultSymbol;
            document.getElementById('intervalSelect').value = settings.defaultInterval;
            document.getElementById('limitSelect').value = settings.defaultLimit;
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
            if (settings.autoRefresh) {
                startAutoRefresh();
            } else {
                stopAutoRefresh();
            }
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
            bootstrap.Modal.getInstance(document.getElementById('settingsModal')).hide();
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
            showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }

        // Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        let autoRefreshInterval = null;

        function startAutoRefresh() {
            if (autoRefreshInterval) return;
            
            autoRefreshInterval = setInterval(() => {
                if (document.getElementById('symbolInput').value) {
                    analyzeAdvanced();
                }
            }, 5 * 60 * 1000); // ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
            
            showNotification('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ', 'info');
        }

        function stopAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
                showNotification('ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ', 'info');
            }
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
        function showHelp() {
            const helpHTML = `
                <div class="modal fade" id="helpModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">
                                    <i class="fas fa-question-circle"></i>
                                    Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="accordion" id="helpAccordion">
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#help1">
                                                Ù…Ø§ Ù‡ÙŠ Ù†Ø¸Ø±ÙŠØ© Elliott WaveØŸ
                                            </button>
                                        </h2>
                                        <div id="help1" class="accordion-collapse collapse show" data-bs-parent="#helpAccordion">
                                            <div class="accordion-body">
                                                Ù†Ø¸Ø±ÙŠØ© Elliott Wave Ù‡ÙŠ Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ ÙÙ†ÙŠ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙÙƒØ±Ø© Ø£Ù† Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ© ØªØªØ­Ø±Ùƒ ÙÙŠ Ø¯ÙˆØ±Ø§Øª Ù…ØªÙƒØ±Ø±Ø© Ù…Ù† 5 Ù…ÙˆØ¬Ø§Øª ÙÙŠ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ùˆ 3 Ù…ÙˆØ¬Ø§Øª ØªØµØ­ÙŠØ­ÙŠØ©.
                                                <br><br>
                                                <strong>Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„Ø¯Ø§ÙØ¹Ø© (1, 3, 5):</strong> ØªØªØ­Ø±Ùƒ Ù…Ø¹ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
                                                <br>
                                                <strong>Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ© (2, 4):</strong> ØªØªØ­Ø±Ùƒ Ø¶Ø¯ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help2">
                                                ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­Ù„Ù„
                                            </button>
                                        </h2>
                                        <div id="help2" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                                            <div class="accordion-body">
                                                <ol>
                                                    <li>Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…Ø´ÙØ±Ø© (Ù…Ø«Ù„ BTCUSDT)</li>
                                                    <li>Ø§Ø®ØªØ± Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</li>
                                                    <li>Ø­Ø¯Ø¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ù…ÙˆØ¹ Ù„Ù„ØªØ­Ù„ÙŠÙ„</li>
                                                    <li>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "ØªØ­Ù„ÙŠÙ„ Ù…ØªÙ‚Ø¯Ù…" Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</li>
                                                    <li>Ø§Ø³ØªØ®Ø¯Ù… "Ù…Ø³Ø­ Ø§Ù„Ø³ÙˆÙ‚" Ù„ÙØ­Øµ Ø¹Ø¯Ø© Ø¹Ù…Ù„Ø§Øª</li>
                                                </ol>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help3">
                                                ÙÙ‡Ù… Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø«Ù‚Ø©
                                            </button>
                                        </h2>
                                        <div id="help3" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                                            <div class="accordion-body">
                                                <div class="alert alert-success">
                                                    <strong>Ø¹Ø§Ù„ÙŠØ© (70%+):</strong> Ø¥Ø´Ø§Ø±Ø§Øª Ù‚ÙˆÙŠØ© ÙˆÙ…ÙˆØ«ÙˆÙ‚Ø©
                                                </div>
                                                <div class="alert alert-warning">
                                                    <strong>Ù…ØªÙˆØ³Ø·Ø© (50-70%):</strong> Ø¥Ø´Ø§Ø±Ø§Øª Ù…Ø¹ØªØ¯Ù„Ø© ØªØ­ØªØ§Ø¬ ØªØ£ÙƒÙŠØ¯
                                                </div>
                                                <div class="alert alert-danger">
                                                    <strong>Ù…Ù†Ø®ÙØ¶Ø© (Ø£Ù‚Ù„ Ù…Ù† 50%):</strong> Ø¥Ø´Ø§Ø±Ø§Øª Ø¶Ø¹ÙŠÙØ©ØŒ ØªØ¯Ø§ÙˆÙ„ Ø¨Ø­Ø°Ø±
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help4">
                                                Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ÙÙ†ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
                                            </button>
                                        </h2>
                                        <div id="help4" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                                            <div class="accordion-body">
                                                <ul>
                                                    <li><strong>RSI:</strong> Ù…Ø¤Ø´Ø± Ø§Ù„Ù‚ÙˆØ© Ø§Ù„Ù†Ø³Ø¨ÙŠØ© (ØªØ´Ø¨Ø¹ Ø´Ø±Ø§Ø¡/Ø¨ÙŠØ¹)</li>
                                                    <li><strong>MACD:</strong> ØªÙ‚Ø§Ø±Ø¨ ÙˆØªØ¨Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªÙˆØ³Ø·Ø§Øª Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©</li>
                                                    <li><strong>Bollinger Bands:</strong> Ù†Ø·Ø§Ù‚Ø§Øª Ø¨ÙˆÙ„ÙŠÙ†Ø¬Ø±</li>
                                                    <li><strong>Stochastic:</strong> Ù…Ø°Ø¨Ø°Ø¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠ</li>
                                                    <li><strong>Fibonacci:</strong> Ù…Ø³ØªÙˆÙŠØ§Øª ÙÙŠØ¨ÙˆÙ†Ø§ØªØ´ÙŠ</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help5">
                                                Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±
                                            </button>
                                        </h2>
                                        <div id="help5" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                                            <div class="accordion-body">
                                                <div class="alert alert-warning">
                                                    <strong>ØªØ­Ø°ÙŠØ±:</strong> Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­Ù„Ù„ Ø£Ø¯Ø§Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙ‚Ø· ÙˆÙ„ÙŠØ³ Ù†ØµÙŠØ­Ø© Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©
                                                </div>
                                                <ul>
                                                    <li>Ù„Ø§ ØªØ³ØªØ«Ù…Ø± Ø£ÙƒØ«Ø± Ù…Ù…Ø§ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ù…Ù„ Ø®Ø³Ø§Ø±ØªÙ‡</li>
                                                    <li>Ø§Ø³ØªØ®Ø¯Ù… ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ø¯Ø§Ø¦Ù…Ø§Ù‹</li>
                                                    <li>Ù†ÙˆØ¹ Ù…Ø­ÙØ¸ØªÙƒ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©</li>
                                                    <li>Ø§Ø·Ù„Ø¨ Ø§Ù„Ù…Ø´ÙˆØ±Ø© Ù…Ù† Ø®Ø¨ÙŠØ± Ù…Ø§Ù„ÙŠ</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">ÙÙ‡Ù…Øª</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', helpHTML);
            const modal = new bootstrap.Modal(document.getElementById('helpModal'));
            modal.show();
            
            document.getElementById('helpModal').addEventListener('hidden.bs.modal', function () {
                this.remove();
            });
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
            notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; max-width: 300px;';
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
        function loadUserSettings() {
            const savedSettings = localStorage.getItem('elliottWaveUserSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                if (settings.autoRefresh) {
                    startAutoRefresh();
                }
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ù„Ù„
                if (app.analyzer) {
                    app.analyzer.sensitivity = parseInt(settings.waveSensitivity) || 5;
                    app.analyzer.minConfidence = parseInt(settings.minConfidence) || 50;
                }
            }
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø©
        function addStatusBar() {
            const statusHTML = `
                <div class="fixed-bottom bg-dark text-white p-2" id="statusBar" style="font-size: 0.8rem;">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-3">
                                <span id="connectionStatus">
                                    <i class="fas fa-circle text-success"></i>
                                    Ù…ØªØµÙ„
                                </span>
                            </div>
                            <div class="col-md-3">
                                <span id="lastUpdate">
                                    Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: --
                                </span>
                            </div>
                            <div class="col-md-3">
                                <span id="analysisCount">
                                    Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª: 0
                                </span>
                            </div>
                            <div class="col-md-3">
                                <span id="activeAlerts">
                                    Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª: ${alertManager.getActiveAlerts().length}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', statusHTML);
        }

        // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø©
        function updateStatusBar() {
            const lastUpdateEl = document.getElementById('lastUpdate');
            const analysisCountEl = document.getElementById('analysisCount');
            const activeAlertsEl = document.getElementById('activeAlerts');
            
            if (lastUpdateEl) {
                lastUpdateEl.textContent = `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${new Date().toLocaleTimeString('ar-SA')}`;
            }
            if (analysisCountEl) {
                analysisCountEl.textContent = `Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª: ${app.analysisHistory.length}`;
            }
            
            if (activeAlertsEl) {
                activeAlertsEl.textContent = `Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª: ${alertManager.getActiveAlerts().length}`;
            }
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø© Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù…Ù„Ø§Øª
        function showComparisonTool() {
            const comparisonHTML = `
                <div class="modal fade" id="comparisonModal" tabindex="-1">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">
                                    <i class="fas fa-balance-scale"></i>
                                    Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Øª
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row mb-3">
                                    <div class="col-md-8">
                                        <input type="text" class="form-control" id="comparisonSymbols" 
                                               placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù…ÙˆØ² Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø© (Ù…Ø«Ù„: BTCUSDT,ETHUSDT,ADAUSDT)">
                                    </div>
                                    <div class="col-md-4">
                                        <button class="btn btn-primary" onclick="startComparison()">
                                            <i class="fas fa-play"></i>
                                            Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
                                        </button>
                                    </div>
                                </div>
                                
                                <div id="comparisonResults">
                                    <div class="text-center text-muted">
                                        <i class="fas fa-chart-line fa-3x mb-3"></i>
                                        <p>Ø£Ø¯Ø®Ù„ Ø±Ù…ÙˆØ² Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', comparisonHTML);
            const modal = new bootstrap.Modal(document.getElementById('comparisonModal'));
            modal.show();
            
            document.getElementById('comparisonModal').addEventListener('hidden.bs.modal', function () {
                this.remove();
            });
        }

        // ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
        async function startComparison() {
            const symbolsInput = document.getElementById('comparisonSymbols').value;
            const symbols = symbolsInput.split(',').map(s => s.trim().toUpperCase()).filter(s => s);
            
            if (symbols.length < 2) {
                showNotification('ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù…Ù„ØªÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©', 'warning');
                return;
            }
            
            const resultsContainer = document.getElementById('comparisonResults');
            resultsContainer.innerHTML = `
                <div class="text-center">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...</span>
                    </div>
                    <p class="mt-2">Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ ${symbols.length} Ø¹Ù…Ù„Ø©...</p>
                </div>
            `;
            
            const comparisons = [];
            
            for (const symbol of symbols) {
                try {
                    const result = await app.analyzeSymbol(symbol, '4h', 200);
                    if (result.success) {
                        comparisons.push({
                            symbol,
                            analysis: result.analysis,
                            summary: result.summary
                        });
                    }
                } catch (error) {
                    console.error(`Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù„ÙŠÙ„ ${symbol}:`, error);
                }
            }
            
            displayComparisonResults(comparisons);
        }

        // Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
        function displayComparisonResults(comparisons) {
            if (comparisons.length === 0) {
                document.getElementById('comparisonResults').innerHTML = `
                    <div class="alert alert-danger">
                        Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø© Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
                    </div>
                `;
                return;
            }
            
            // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©
            comparisons.sort((a, b) => (b.analysis.enhancedConfidence || b.analysis.confidence) - (a.analysis.enhancedConfidence || a.analysis.confidence));
            
            const comparisonHTML = `
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ø¹Ù…Ù„Ø©</th>
                                <th>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©</th>
                                <th>Ø§Ù„Ø§ØªØ¬Ø§Ù‡</th>
                                <th>Ù‚ÙˆØ© Ø§Ù„Ø§ØªØ¬Ø§Ù‡</th>
                                <th>Ø§Ù„ØªÙˆØµÙŠØ©</th>
                                <th>Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${comparisons.map((comp, index) => `
                                <tr class="${index === 0 ? 'table-success' : ''}">
                                    <td>
                                        <strong>${comp.symbol}</strong>
                                        ${index === 0 ? '<span class="badge bg-success ms-2">Ø§Ù„Ø£ÙØ¶Ù„</span>' : ''}
                                    </td>
                                    <td>
                                        <div class="progress" style="width: 80px;">
                                            <div class="progress-bar bg-${getConfidenceColor(comp.analysis.enhancedConfidence || comp.analysis.confidence)}" 
                                                 style="width: ${comp.analysis.enhancedConfidence || comp.analysis.confidence}%">
                                                ${(comp.analysis.enhancedConfidence || comp.analysis.confidence).toFixed(0)}%
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-${comp.analysis.trend.direction.includes('bullish') ? 'success' : 'danger'}">
                                            ${comp.analysis.trend.direction}
                                        </span>
                                    </td>
                                    <td>${comp.analysis.trend.strength}%</td>
                                    <td>
                                        <span class="badge bg-${getRecommendationColor(comp.summary.recommendation)}">
                                            ${comp.summary.recommendation}
                                        </span>
                                    </td>
                                    <td>
                                        <span class="badge bg-${getRiskColor(comp.summary.riskLevel)}">
                                            ${comp.summary.riskLevel}
                                        </span>
                                    </td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary" onclick="loadSymbolForAnalysis('${comp.symbol}')">
                                            ØªØ­Ù„ÙŠÙ„ Ù…ÙØµÙ„
                                        </button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-12">
                        <h6>Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©:</h6>
                        <div class="alert alert-info">
                            <ul class="mb-0">
                                <li><strong>Ø£ÙØ¶Ù„ ÙØ±ØµØ©:</strong> ${comparisons[0].symbol} Ø¨Ø«Ù‚Ø© ${(comparisons[0].analysis.enhancedConfidence || comparisons[0].analysis.confidence).toFixed(0)}%</li>
                                <li><strong>Ù…ØªÙˆØ³Ø· Ø§Ù„Ø«Ù‚Ø©:</strong> ${(comparisons.reduce((sum, c) => sum + (c.analysis.enhancedConfidence || c.analysis.confidence), 0) / comparisons.length).toFixed(0)}%</li>
                                <li><strong>Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„ØµØ§Ø¹Ø¯Ø©:</strong> ${comparisons.filter(c => c.analysis.trend.direction.includes('bullish')).length} Ù…Ù† ${comparisons.length}</li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('comparisonResults').innerHTML = comparisonHTML;
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¹Ù…Ù„Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙØµÙ„
        function loadSymbolForAnalysis(symbol) {
            document.getElementById('symbolInput').value = symbol;
            bootstrap.Modal.getInstance(document.getElementById('comparisonModal')).hide();
            analyzeAdvanced();
        }

        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø£Ù„ÙˆØ§Ù†
        function getConfidenceColor(confidence) {
            if (confidence >= 70) return 'success';
            if (confidence >= 50) return 'warning';
            return 'danger';
        }

        function getRiskColor(riskLevel) {
            switch (riskLevel) {
                case 'Ù…Ù†Ø®ÙØ¶Ø©': return 'success';
                case 'Ù…ØªÙˆØ³Ø·Ø©': return 'warning';
                case 'Ø¹Ø§Ù„ÙŠØ©': return 'danger';
                default: return 'secondary';
            }
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø© Ø§Ù„ØªÙ†Ø¨Ø¤Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
        class PredictionEngine {
            static generatePredictions(analysis, data) {
                const predictions = {
                    shortTerm: this.predictShortTerm(analysis, data),
                    mediumTerm: this.predictMediumTerm(analysis, data),
                    longTerm: this.predictLongTerm(analysis, data),
                    scenarios: this.generateScenarios(analysis, data)
                };
                
                return predictions;
            }

            static predictShortTerm(analysis, data) {
                const currentPrice = data[data.length - 1].close;
                const trend = analysis.trend;
                
                let targetPrice, probability;
                
                if (trend.direction.includes('bullish')) {
                    targetPrice = currentPrice * (1 + (trend.strength / 1000));
                    probability = Math.min(trend.strength + 20, 85);
                } else {
                    targetPrice = currentPrice * (1 - (trend.strength / 1000));
                    probability = Math.min(trend.strength + 15, 80);
                }
                
                return {
                    timeframe: '24 Ø³Ø§Ø¹Ø©',
                    targetPrice: targetPrice.toFixed(4),
                    currentPrice: currentPrice.toFixed(4),
                    change: (((targetPrice - currentPrice) / currentPrice) * 100).toFixed(2),
                    probability: probability.toFixed(0),
                    confidence: analysis.confidence
                };
            }

            static predictMediumTerm(analysis, data) {
                const currentPrice = data[data.length - 1].close;
                const fibLevels = analysis.fibonacci;
                
                let targetPrice;
                if (analysis.trend.direction.includes('bullish')) {
                    targetPrice = fibLevels.extensions[1] || currentPrice * 1.15;
                } else {
                    targetPrice = fibLevels.retracements[2] || currentPrice * 0.85;
                }
                
                return {
                    timeframe: 'Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯',
                    targetPrice: targetPrice.toFixed(4),
                    currentPrice: currentPrice.toFixed(4),
                    change: (((targetPrice - currentPrice) / currentPrice) * 100).toFixed(2),
                    probability: Math.max(analysis.confidence - 10, 30).toFixed(0),
                    confidence: analysis.confidence
                };
            }

            static predictLongTerm(analysis, data) {
                const currentPrice = data[data.length - 1].close;
                const waveCount = analysis.waves.length;
                
                let multiplier = 1;
                if (waveCount >= 5) {
                    multiplier = analysis.trend.direction.includes('bullish') ? 1.3 : 0.7;
                } else {
                    multiplier = analysis.trend.direction.includes('bullish') ? 1.2 : 0.8;
                }
                
                const targetPrice = currentPrice * multiplier;
                
                return {
                    timeframe: 'Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯',
                    targetPrice: targetPrice.toFixed(4),
                    currentPrice: currentPrice.toFixed(4),
                    change: (((targetPrice - currentPrice) / currentPrice) * 100).toFixed(2),
                    probability: Math.max(analysis.confidence - 20, 25).toFixed(0),
                    confidence: analysis.confidence
                };
            }

            static generateScenarios(analysis, data) {
                const currentPrice = data[data.length - 1].close;
                
                return {
                    bullish: {
                        name: 'Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„ØµØ§Ø¹Ø¯',
                        probability: analysis.trend.direction.includes('bullish') ? 65 : 35,
                        target: (currentPrice * 1.25).toFixed(4),
                        description: 'ÙƒØ³Ø± Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø© ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµØ§Ø¹Ø¯'
                    },
                    bearish: {
                        name: 'Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„Ù‡Ø§Ø¨Ø·',
                        probability: analysis.trend.direction.includes('bearish') ? 65 : 35,
                        target: (currentPrice * 0.75).toFixed(4),
                        description: 'ÙƒØ³Ø± Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø¯Ø¹Ù… ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‡Ø§Ø¨Ø·'
                    },
                    sideways: {
                        name: 'Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ',
                        probability: 30,
                        target: currentPrice.toFixed(4),
                        description: 'Ø­Ø±ÙƒØ© Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¨ÙŠÙ† Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø©'
                    }
                };
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª
       // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª        
function displayPredictions(predictions) {
    if (!predictions) return '';
                    
    return `
        <div class="card mb-3">
            <div class="card-header">
                <h6><i class="fas fa-crystal-ball"></i> Ø§Ù„ØªÙ†Ø¨Ø¤Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card border-success">
                            <div class="card-header bg-success text-white">
                                <small>${predictions.shortTerm.timeframe}</small>
                            </div>
                            <div class="card-body">
                                <div class="text-center">
                                    <h6>${predictions.shortTerm.targetPrice}</h6>
                                    <span class="badge bg-${predictions.shortTerm.change > 0 ? 'success' : 'danger'}">
                                        ${predictions.shortTerm.change}%
                                    </span>
                                    <div class="mt-2">
                                        <small>Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ©: ${predictions.shortTerm.probability}%</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                                            
                    <div class="col-md-4">
                        <div class="card border-warning">
                            <div class="card-header bg-warning text-dark">
                                <small>${predictions.mediumTerm.timeframe}</small>
                            </div>
                            <div class="card-body">
                                <div class="text-center">
                                    <h6>${predictions.mediumTerm.targetPrice}</h6>
                                    <span class="badge bg-${predictions.mediumTerm.change > 0 ? 'success' : 'danger'}">
                                        ${predictions.mediumTerm.change}%
                                    </span>
                                    <div class="mt-2">
                                        <small>Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ©: ${predictions.mediumTerm.probability}%</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                                            
                    <div class="col-md-4">
                        <div class="card border-info">
                            <div class="card-header bg-info text-white">
                                <small>${predictions.longTerm.timeframe}</small>
                            </div>
                            <div class="card-body">
                                <div class="text-center">
                                    <h6>${predictions.longTerm.targetPrice}</h6>
                                    <span class="badge bg-${predictions.longTerm.change > 0 ? 'success' : 'danger'}">
                                        ${predictions.longTerm.change}%
                                    </span>
                                    <div class="mt-2">
                                        <small>Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ©: ${predictions.longTerm.probability}%</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                                        
                <div class="row mt-3">
                    <div class="col-md-12">
                        <h6>Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©:</h6>
                        <div class="row">
                            ${Object.entries(predictions.scenarios).map(([key, scenario]) => `
                                <div class="col-md-4">
                                    <div class="alert alert-${key === 'bullish' ? 'success' : key === 'bearish' ? 'danger' : 'secondary'} p-2">
                                        <strong>${scenario.name}</strong><br>
                                        <small>Ø§Ù„Ù‡Ø¯Ù: ${scenario.target}</small><br>
                                        <small>Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ©: ${scenario.probability}%</small><br>
                                        <small class="text-muted">${scenario.description}</small>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}


// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ù…Ø­Ø³Ù† Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ†Ø¨Ø¤Ø§Øª        
class FinalElliottWaveAnalyzer extends EnhancedElliottWaveAnalyzer {
    analyzeData(data) {
        const baseAnalysis = super.analyzeData(data);
                        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ†Ø¨Ø¤Ø§Øª
        const predictions = PredictionEngine.generatePredictions(baseAnalysis, data);
                        
        return {
            ...baseAnalysis,
            predictions
        };
    }
}

// ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ        
app.analyzer = new FinalElliottWaveAnalyzer();

// ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„ØªØ´Ù…Ù„ Ø§Ù„ØªÙ†Ø¨Ø¤Ø§Øª
function updateResults(analysis) {
    const resultsDiv = document.getElementById('results');
    if (!resultsDiv) return;
    
    resultsDiv.innerHTML = `
        ${displayChart(analysis)}
        ${displayWaveDetails(analysis.waves)}
        ${displayFibonacci(analysis.fibonacci)}
        ${displayPatterns(analysis.patterns)}
        ${displayPredictions(analysis.predictions)}
    `;
}

// Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø±Ùƒ Ø§Ù„ØªÙ†Ø¨Ø¤Ø§Øª
class PredictionEngine {
    static generatePredictions(analysis, data) {
        return {
            shortTerm: {
                timeframe: "Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰",
                targetPrice: "45,250",
                change: 2.5,
                probability: 75
            },
            mediumTerm: {
                timeframe: "Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø¯Ù‰", 
                targetPrice: "48,000",
                change: 5.8,
                probability: 65
            },
            longTerm: {
                timeframe: "Ø·ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¯Ù‰",
                targetPrice: "52,000", 
                change: 12.3,
                probability: 55
            },
            scenarios: {
                bullish: {
                    name: "Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„ØµØ§Ø¹Ø¯",
                    target: "55,000",
                    probability: 60,
                    description: "ÙƒØ³Ø± Ø§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"
                },
                bearish: {
                    name: "Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„Ù‡Ø§Ø¨Ø·", 
                    target: "38,000",
                    probability: 25,
                    description: "ÙƒØ³Ø± Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ù‡Ù…"
                },
                neutral: {
                    name: "Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„Ù…Ø­Ø§ÙŠØ¯",
                    target: "44,000", 
                    probability: 15,
                    description: "ØªØ¯Ø§ÙˆÙ„ Ø¬Ø§Ù†Ø¨ÙŠ"
                }
            }
        };
    }
}

    </script>
</body>
</html>
